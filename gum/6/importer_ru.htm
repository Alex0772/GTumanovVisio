<html>
<head>
<title>Трафарет для импорта данных</title>

<meta name="GENERATOR" content="MSHTML 5.00.2614.3500">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<LINK REL="stylesheet" HREF="/gum/visg.css" type="text/css" />
</head>
<body bgcolor="white">
<div class="body_div">
<div id="menu-line">Other my products for Visio that might be of interest to you:
<a class="menu" href="/vd/gum.htm"> sale</a> | <a class="menu" href="/vd/development.htm"> development</a>
</div>
<!-- end header --------------------------- -->
<!-- ============================================= -->
<h1>Трафарет для импорта данных</h1>
<table border="0" cellpadding="20" cellspacing="0" width="100%">
<tr>
<td width="20%" bgcolor="FFFFFF">
<IMG SRC="pr.jpg" WIDTH="200" HEIGHT="133" BORDER="0" ALT="">
</td>
<td width="50%" bgcolor="FFFFFF">
<p><b>Инструмент для быстрого импорта и автопостроения диаграмм.</b></p>
<p>Трафарет содержит шейп-импортер и несколько макросов. Построение диаграммы
сводится к тому, чтобы перебросить данные через буфер Windows и выполнить
команду "Draw". Остальное трафарет сделает автоматически.</p>
</td>
<td width="30%" bgcolor="FFFFFF">
<script src="https://gumroad.com/js/gumroad.js"></script>
<a class="gumroad-button" href="https://gum.co/XBmS">Buy on Gumroad</a>
</td>
</tr>
</table>
<hr>

<h3>Область применения</h3>
<p>Некоторые дополнения Visio имеют встроенные средства для
импорта данных и автоматического построения диаграммы.
В частности, "Мозговой штурм", "Организационная схема".
Но таких мало. Если вы имеете навыки программирования,
то можно самому написать макрос для импорта данных. Но это не очень быстро.</p>
<p>Здесь предлагается другой путь - шейп-импортер.
Шейп содержит несколько наиболее распространенных алгоритмов построения диаграмм.
Все операции максимально упрощены.
Для построения диаграммы достаточно буквально несколько кликов.</p>
<p>Естественно, такой подход не закроет всех потребностей в импорте данных.
Но будем надеяться, что он войдет в число привычных и часто используемых инструментов.</p>

<h3>Общая методика применения</h3>
<p>Трафарет можно использовать в произвольном документе. Нужно только бросить
порцию данных в шейп-импортер и выполнить пункт контекстного меню.
Шейп выполнит всю необходимую работу. На листе появится автоматически
построенное изображение.</p>

<table border="0" cellpadding="20" cellspacing="0" width="100%">
<tr>
<td width="20%" bgcolor="FFFFFF">
<a target="New" href="f/ip1.gif"><IMG SRC="pr001.jpg" WIDTH="300" HEIGHT="200" BORDER="0" ALT=""></a>
</td>
<td width="80%" bgcolor="FFFFFF">
<p><a target="New" href="f/ip1.gif">Смотрите пример импорта и построения диаграммы сети по данным из Excel.</a></p>
<p>В примере выполняется следующая последовательность действий:</p>
<UL>
<LI> открыть трафарет
<LI> перенести шейп-импортер
<LI> бросить в него порцию данных
<LI> выполнить пункт контекстного меню.
</UL>
</td></tr></table>

<h3>Варианты использования</h3>
<p>Шейп-импортер настроен на несколько самых распространенных форматов данных.</p>
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td  bgcolor="FFFFFF">
<IMG SRC="pr000_r1.png" WIDTH="200" HEIGHT="50" BORDER="0" ALT="">
</td>
<td bgcolor="FFFFFF">
Одна колонка - массив шейпов</td>
<td bgcolor="FFFFFF">
<IMG SRC="pr000_r2.png" WIDTH="200" HEIGHT="50" BORDER="0" ALT="">
</td>
<td bgcolor="FFFFFF">
2 колонки - дерево - связанные шейпы, один мастер</td></tr>
<tr><td bgcolor="FFFFFF">
<IMG SRC="pr000_r3.png" WIDTH="200" HEIGHT="50" BORDER="0" ALT="">
</td>
<td bgcolor="FFFFFF">
4 колонки - дерево, разные мастер-шейпы</td>
<td bgcolor="FFFFFF">
<IMG SRC="pr000_r4.png" WIDTH="200" HEIGHT="50" BORDER="0" ALT="">
</td>
<td bgcolor="FFFFFF">
6 колонок - дерево, разные мастера, параметр</td></tr>
</table>
<p>Модификации. 2 основных модификации, отличающиеся размещением шейпов.
Дерево - по типу Orgchart. Сеть - узлы, соединенные прямыми линиями.
После построения диаграммы Вы можете изменить размещение, используя штатные
функции авторазмещения Visio.</p>

<h3>Массив шейпов.</h3>
<p>Функция используется, когда требуется преобразовать множество
строк в множество шейпов. Например, имеется текст алгоритма, нужно
получить блок-схему. На картинке показана последовательность действий.</p>
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td width="20%" bgcolor="FFFFFF">
<a target="New" href="f/pr000_f3.gif"><IMG SRC="pr000_r1.png" WIDTH="200" HEIGHT="50" BORDER="0" ALT=""></a>
</td>
<td width="60%" bgcolor="FFFFFF">
<p>На <a target="New" href="f/pr000_f3.gif">картинке</a> последовательно показаны следующие операции:</p>
<UL>
<LI>скопировать текст в буфер
<LI>скопировать содержимое буфера в блокнот
<LI>открыть трафарет import
<LI>перенести шейп-импортер на страницу
<LI>вставить текст из буфера
<LI>открыть Document Stencil, выбрать нужный мастер-шейп
<LI>выполнить пункт меню Draw Array
</UL>
<p>Далее использован мастер-шейп ArrayController:</p>
<UL>
<LI>перенести шейп на страницу (шейп превращается в форму)
<LI>селектировать ранее нарисованную диаграмму, нажать кнопку ...
<LI>установить CheckBox в состояние "Столбцы"
<LI>клавишами Стрелка уменьшить количество столбцов до одного (вертикальное расположение)
</UL>
</td></tr>
</table>
<p>Примечание. Возможности мастер-шейпа ArrayController описаны ниже.</p>
<p>Правила. Исходные данные должны размещаться в одной колонке. Каждая
строка преобразуется в шейп. Шейп строится на основе селектированного
мастер-шейпа. То есть, выбирая различные мастер-шейпы Вы получите различные
массивы. Данные выводятся в виде текста шейпа.</p>
<p>По умолчанию массив содержит 10 колонок. Количество строк зависит
от объема данных. Интервалы зависят от размера шейпа.</p>
<p>Трафарет содержит также шейп управления массивом</p>
<p>Шейп управления массивом позволяет:</p>
<UL>
<LI>перестраивать массив шейпов, уменьшая или увеличивая количество колонок;
<LI>сжимать и раздвигать шейпы массива по горизонтали и вертикали (не изменяя размера шейпов);
<LI>при одновременном нажатии клавиши Shift обеспечивается уменьшенный шаг сдвига;
<LI>вписать массив в область заданных размеров;
<LI>задать интервал между центрами или краями шейпов.
</UL>
<p>По умолчанию шейпы соединяются коннекторами. Если нужно получить массив
не связанных шейпов, достаточно с помощью функции "Выбор по типу" выбрать
шейпы на слое "Соединительная линия" и удалить их (Меню "Правка / Выбор по типу").</p> 

<table><tr><td>
<h3>2 колонки</h3>
<div style="float:left; padding:10pt">
<IMG SRC="pr000_r91.png" WIDTH="150" HEIGHT="200" BORDER="0" ALT="">
</div>
<div>
<p>Типовое применение - отображение связей между шейпами. Например,
оргструктуры или потоков данных между аппаратурой.
В <a target="New" href="f/ip1.gif">примере</a> показаны следующие операции:</p>
<UL style="margin-left:160pt">
	<LI>открыть трафарет
	<LI>перенести мастер ImportBox на страницу
	<LI>скопировать данные из Excel в блокнот
	<LI>перенести данные из блокнота в ImportBox
	<LI>открыть нужный трафарет и выбрать мастер-шейп
	<LI>выполнить функцию Draw Network
</UL>
<p>В результате импорта на листе будут нарисованы связи, представленные
в импортируемых данных</p>
<p>Требования к данным. Данные должны быть представлены в двух колонках,
разделенных знаком табуляции. При копировании из Excel или БД
рекомендуется использовать промежуточное копирование в блокнот,
тогда разделитель вставляется по умолчанию.</p>
<p>Обе колонки должны содержать имена узлов (текст шейпа).</p>
<p>Первая колонка - источник, вторая - приемник.
(Для оргструктуры - Executive - Reprot To).</p>
<p>Для отображения всех узлов используется мастер-шейп,
который будет селектирован в момент выполнения команды Draw. Коннекторы одинаковые,
используется Dynamic connector.</p>
<p>Мастер-шейп использует два формата отображения: Draw Tree и
Draw Network, которые отличаются методом размещения шейпов и типом
линий. Если вам требуется другое расположение, то после импорта
вы можете изменить его вручную или с помощью штатных команд авторазмещения.</p>
</div>
</td></tr></table>

<table><tr><td>
<h3>4 колонки</h3>
<div style="float:left; padding:10pt">
<a target="New" href="f/pr000_f4.gif"><IMG SRC="pr000_r8.png" WIDTH="160" HEIGHT="200" BORDER="0" ALT=""></a>
</div>
<div>
<p>Такой режим позволяет использовать различные мастера и различные коннекторы.
В <a target="New" href="f/pr000_f4.gif">примере</a> изображение строится с помощью четырех разных мастер-шейпов.</p>
<p>Колонки 1 и 2, как и в предыдущем примере, устанавливают тип источника и приемника.
Колонка 3 содержит имя мастер-шейпа для 2D шейпов. Колонка 4 - имя мастер-шейпа для коннектора.</p>
<p>Все узлы обязательно должны присутствовать в первой колонке.
Для корневых узлов поле Report to следует оставлять пустым.</p>
<p>Тонкости. Все мастер-шейпы должны присутствовать в Document Stencil.
Иначе будет выведено сообщение об ошибке, например "Master Server is missing". Чтобы перенести нужные
мастер-шейпы из основного трафарета в Document Stencil нужно перенести их
на страницу документа и удалить. При этом копии появятся в Document Stencil.</p>
<p>Импортер по умолчанию работает с локальными именами мастер-шейпов.
В платной версии есть возможность переключиться на универсальные имена.
Для этого нужно открыть редактор и изменить значение константы UseUniversal
на True. В бесплатной версии код недоступен, поэтому такая возможность отсутствует.</p>
<p>Private Const UseUniversal As Boolean = True</p>
</div>
</td></tr></table>

<table><tr><td>
<h3>6 колонок</h3>
<div style="float:left; padding:5pt">
<IMG SRC="pr000_r9.png" WIDTH="200" HEIGHT="200" BORDER="0" ALT="">
</div>
<p>Такой режим позволяет не только использовать различные мастера,
но и передавать в них дополнительный параметр. Это позволить управлять цветом,
толщиной линии или конфигурацией шейпов.</p>
<p>Значение управляющего параметра должно быть занесено в 5 колонку
для 2D шейпа и в 6 колонку для коннектора в виде целого числа.</p>
<p>Мастер-шейпы должны быть предварительно подготовлены. Значение параметра
передается в ячейку "User.importP". Значит шейп должен содержать секцию
"User-defined cells" с таким именем и формулу управления отображением,
связанную с этой ячейкой. <a target="new" href="importer_dop_ru.htm#id001">Пример ниже</a> показывает,
как организовать зависимость цвета заливки шейпа от параметра. </p>
<p>Если шейп не содержит ячейку "User.importP", то параметр не будет
передан и функция "Draw with parameters" будет работать так же, как функция "Draw with masters".</p>
</td></tr></table>

<div>
<h3>Отличия в версиях</h3>
<p>Существуют две версии трафарета: платная и бесплатная.</p>
<p>Отличие бесплатной версии в том, что ее код закрыт и она периодически
выводит напоминание о возможности покупки платной версии.
В остальном обе версии одинаковы. То есть вы можете загрузить
бесплатную версию, убедиться, что она вам подходит и потом купить платную версию.</p>
<p>Открытый код при необходимости позволяет убедиться в безопасности
имеющихся макросов и может быть использован для создания своих модификаций,
выполняющих отличающиеся или дополнительные задачи.</p>
</div>

<h3>Размещение и способ применения</h3>
<p>Весь функционал полностью размещен в трафарете import.vss.</p>
<p>Трафарет не требует инсталляции или наличия других компонентов.
Тем не менее для удобства применения лучше положить его в папку,
которую Visio использует для хранения пользовательских трафаретов.
Например, в My Documents\My Shapes или папку, которая прописана в настройках Visio.
Тогда его будет удобно открывать с любым нужным документом.</p>

<h3>Техническая поддержка</h3>
<p>В случае возникновения вопросов или предложений вы можете связаться
с автором по указанному ниже адресу.</p>

<HR>
<h3>Дополнения</h3>
<UL>
	<LI><a target="new" href="importer_dop_ru.htm#id001">Как сделать шейп с управляемой заливкой</a>
	<LI><a target="new" href="importer_dop_ru.htm#id002">Как разрешить применение макросов</a>
	<LI><a target="new" href="importer_dop_ru.htm#id003">Как изменить размещение шейпов</a>
	<LI><a target="new" href="importer_dop_ru.htm#id004">Функция селектирования</a>
</UL>

<br/>
<!-- ============================================= -->
<div id="menu-line">
<a href="mailto:gCroc@yandex.ru">Gennady Tumanov</a>
</div>
<!-- HotLog -->
<!-- /HotLog -->
</body>
</html>
