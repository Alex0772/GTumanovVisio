<html>
<head>
<title>Трафарет для импорта данных</title>

<meta name="GENERATOR" content="MSHTML 5.00.2614.3500">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<LINK REL="stylesheet" HREF="/gum/visg.css" type="text/css" />
</head>
<body bgcolor="white">
<div class="body_div">
<div id="menu-line">Other my products for Visio that might be of interest to you:
<a class="menu" href="/vd/gum.htm"> sale</a> | <a class="menu" href="/vd/development.htm"> development</a>
</div>
<!-- end header --------------------------- -->
<!-- ============================================= -->
<h1>Трафарет для импорта данных. Дополнение</h1>
<p>Ниже описаны некоторые отдельные приемы, которые могут быть использованы
при работе с трафаретом для импорта данных.</p>
<h3>Содержание</h3>
<UL>
	<LI><a href="#id001">Как сделать шейп с управляемой заливкой</a>
	<LI><a href="#id002">Как разрешить применение макросов</a>
	<LI><a href="#id003">Как изменить размещение шейпов</a>
	<LI><a href="#id004">Функция селектирования</a>
</UL>

<h3 id="id001">Как сделать шейп с управляемой заливкой</h3>
<p>Шейп-импортер может передать в целевой шейп параметр целого типа.</p>
<p>Задача управления разбивается на две части:</p>
<UL>
<LI>передать данные в целевой шейп;
<LI>отобразить переданные данные.
</UL>
<p>Первая задача решается с помощью шейпа-импортера. Шейп передает данные
из колонки 5 в узлы (2D шейпы) и из колонки 6 - в коннекторы (1D шейпы).</p>
<p>Приемником данных в обоих случаях служит ячейка User.importP.
Если такая ячейка отсутствует, данные не передаются.</p>
<p>Колонки 5 и 6 обрабатываются только функциями "Draw Tree with Parameters"
и "Draw Network with Parameters".</p>
<p>Вторая задача решается с помощью пользовательского мастер-шейпа.
Такой шейп не входит в комплект поставки. Пользователь должен изготовить
его сам с учетом решаемой задачи.</p>
<p>Ниже показан пример изготовления такого шейпа. Пусть параметр указывает
номер цвета в палитре (см. меню Сервис / Цветовая палитра).</p>
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td width="20%" bgcolor="FFFFFF">
<a target="New" href="f/pr000_f1.gif"><IMG SRC="pr002.jpg" WIDTH="290" HEIGHT="285" BORDER="0" ALT=""></a>
</td>
<td width="60%" bgcolor="FFFFFF">
<p>На <a target="New" href="f/pr000_f1.gif">картинке</a> последовательно показаны следующие операции:</p>
<UL>
<LI> нарисовать шейп
<LI> открыть шейп-лист
<LI> добавить секцию User-defined cells
<LI> создать ячейку User.importP
<LI> из ячейки FillForegnd сделать ссылку на User.importP
<LI> проверить передачу цвета
<LI> открыть Document Stencil
<LI> перебросить новый шейп в Document Stencil
<LI> переименовать полученный мастер-шейп
<LI> посмотреть номера в палитре.
</UL>
</td></tr>
</table>
<p>Если такой мастер-шейп использовать при импорте данных, то шейп-импортер
будет передавать данные в ячейку User.importP, а целевой шейп будет изменять
цвет заливки в зависимости от переданного значения.Значения параметра должны
меняться в диапазоне (0...23).</p>

<h3 id="id002">Как разрешить применение макросов</h3>
<p>Для Visio 2007</p>
<IMG SRC="pr000_r5.png" WIDTH="420" HEIGHT="200" BORDER="0" ALT="">
<p>Для Visio 2010</p>
<IMG SRC="pr000_r6.png" WIDTH="420" HEIGHT="200" BORDER="0" ALT="">

<h3 id="id003">Как изменить размещение шейпов</h3>
<p>Visio имеет универсальный встроенный инструмент для изменения
расположения шейпов и специализированные инструменты для отдельных дополнений.</p>
<p>Специализированные инструменты доступны только в документах, созданных по
соответствующему шаблону. Это Mind Map и Organization chart.</p>
<p>Универсальные инструменты доступны всегда.</p>
<p>Шейп-импортер использует только два сочетания настроек из универсального
инструмента. То есть по умолчанию может быть создано размещение типа "Сжатое дерево"
или "Горизонтальная блок-схема". После импорта вы можете в любой момент изменить
расположение с помощью универсального инструмента. "Фигура / Настройка макета",
"Фигура / Изменить расположение фигур", "Фигура / Центрировать документ".</p>
<p>Если шейп-импортер использован в "Mind Map" диаграмме, вы можете использовать
меню ... . В "Organization chart" документах доступно меню ... .</p>

<h3 id="id004">Функция селектирования</h3>
Трафарет содержит также функцию SelectSubTree, которую удобно использовать
при ручной корректировке расположения шейпов.
Наилучшие результаты достигаются в том случае, если мастер-шейпы содержат
формулу вызова этой функции. Ниже показано, как сделать такой мастер-шейп.
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td width="20%" bgcolor="FFFFFF">
<a target="New" href="f/pr000_f2.gif"><IMG SRC="pr000_r7.jpg" WIDTH="595" HEIGHT="184" BORDER="0" ALT=""></a>
</td>
<td width="60%" bgcolor="FFFFFF">
<p>На <a target="New" href="f/pr000_f2.gif">картинке</a> последовательно показаны следующие операции:</p>
<UL>
<LI> нарисовать шейп
<LI> открыть шейп-лист
<LI> добавить секцию Actions
<LI> ввести текст =CALLTHIS("mDrawTree.SelectSubTree","import") в ячейку Action
<LI> ввести текст "Select Subtree" в ячейку Menu
<LI> нарисовать дерево и проверить вызов функции
<LI> скопировать шейп в Document Stencil
</UL>
</td></tr>
</table>

<br/>
<!-- ============================================= -->
<div id="menu-line">
<a href="mailto:gCroc@yandex.ru">Gennady Tumanov</a>
</div>
<!-- HotLog -->
<!-- /HotLog -->
</body>
</html>
