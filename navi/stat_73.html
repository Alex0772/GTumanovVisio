<html><head>
<LINK REL="STYLESHEET" HREF="vis.css">
<title>Данные</title>
<meta name="GENERATOR" content="MSHTML 5.00.2614.3500">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<LINK REL="STYLESHEET" HREF="../vis.css">
<link rel="icon" href="../favicon.ico" />
</head>
<body bgcolor="white">
<div class="body_div">
<table class="tft" width="100%"><tr>
<td width="15%" align="center"><a href="../index.html"><img SRC="../vl1.gif" WIDTH="177" HEIGHT="80" BORDER="0" ALT=""></a>&nbsp;</td>
<td width="5%" align="center">&nbsp;</td>
<td class='menutd' width="50%" align="center">
 <a class="menu" href="http://visio.getbb.ru/">Форум visio.getbb.ru</a> |
 <a class="menu" href="../reg.htm">О форумах</a>
<br/>
 <a class="menu" href="../bib.htm">Библиотека</a> |
 <a class="menu" href="../faq.htm">Частые вопросы</a> |
 <a class="menu" href="../bookpdf.htm">Литература</a> |
 <a class="menu" href="../loading.htm">Склад материалов</a>
<br/>
 <a class="menu" href="../navi/png_1.htm">Visio Navigator</a> |
 <a class="menu" href="../blog/">Blog</a> |
 <a class="menu" href="../inforesurs.htm">Полезные ссылки</a> |
 <a class="menu" href="../site.htm">О сайте</a>
<br/>
 <a class="menu" href="../visicorp.htm">История Visio</a> |
 <a class="menu" href="../product.htm">Продукты Visio</a>
</td>
<td width="5%" align="center">&nbsp;</td>
<td width="25%" align="center">
<script async src="https://cse.google.com/cse.js?cx=f5e9a9cb1467f4600">
</script>
<div class="gcse-search"></div>
</td></tr></table>
<table width="100%" cellpadding="0" cellspacing="0" class="min"><tr><td width="10%" align="center">&nbsp;</td>
	<td width="90%">&nbsp;&nbsp;Для русскоязычных пользователей Visio. Начинающих и профессионалов.
Где взять, как сделать, что купить и т.д.
</td></tr></table>
<!-- основной контент -->

<h1>Данные</h1>
<p>Главным преимуществом Visio перед другими похожими программами является возможность взаимодействия шейпов с данными. Шейпы могут хранить данные, обмениваться ими с внешним источником, отображать данные различными способами. Можно создавать схемы, управляемые данными. При рассмотрении этой темы следует выделить три наиболее важных аспекта:</p>
<ul>
<li>хранение данных в шейпах;</li>
<li>связывание данных с шейпами;</li>
<li>визуализация данных.</li>
</ul>
<h2>Хранение данных в шейпах</h2>
<p>При рассмотрении структуры документа Visio уже упоминалось, что каждый шейп содержит большую таблицу, состоящую из секций, строк, ячеек, называемую шейп-лист (ShapeSheet). Эта таблица не только определяет все поведение шейпа, но и может хранить данные. Одни ячейки используются для хранения данных или ссылок на них. Другие с помощью формул преобразуют данные в те или иные графические параметры. Среди всех секций таблицы есть несколько, наиболее тесно связанных с данными:</p>
<ul>
<li>секция Shape Data;</li>
<li>секция User;</li>
<li>секция Scratch.</li>
</ul>
<h2>Секция Shape Data</h2>
<p>Секция Shape Data – используется чаще всего. Ее содержимое даже отображается в специальном окне Shape Data, что позволяет пользователю просматривать и изменять данные, даже не открывая шейп-листа.</p>
<p>Состав секции переменный - в ней может быть как одна, так и множество строк. Секция может вообще отсутствовать. Каждая строка отвечает за хранение одной единицы данных.</p>
<p><img style="width: 473px; height: 87px;" alt="ShapeData" src="st/stst_73_f/Img1.png"><br></p>
<p>В строке имеется несколько ячеек, хранящих такие параметры, как имя строки, метку, тип переменной, значение и т.д. Собственно данные лежат в ячейке Value.</p>
<h2>Секция User (данные, определенные пользователем)</h2>
<p><img style="width: 369px; height: 55px;" alt="user-defined" src="st/stst_73_f/image002.png"><br></p
<p>Эта секция похожа на Shape Data, но отличается тем, что она доступна только через шейп-лист и ее строки имеют меньшее количество ячеек. Поэтому секция чаще используется для хранения промежуточных или скрытых данных, не предназначенных для непосредственного изменения пользователем.</p>
<h2>Секция Scratch</h2>
<p><img style="width: 599px; height: 70px;" alt="scratch" src="st/stst_73_f/image003.png"><br></p>
<p>Еще реже используемая секция, предназначенная в первую очередь для хранения промежуточных результатов при сложных вычислениях. Если в предыдущих двух секциях строка чаще всего определяет единицу данных, то в этой секции строка содержит несколько фрагментов сложной формулы.</p>
<p>Пример использования Shape Data и User-defined cells</p>
<p> </p>
<p><img style="width: 646px; height: 47px;" alt="shapedata" src="st/stst_73_f/image004.png"></p><p><img style="width: 118px; height: 145px;" alt="cup" src="st/stst_73_f/image005.png"><br></p>
<p>Рассмотрим пример использования данных в шейпе на примере стакана кофе. Это шейп-группа, содержащая вложенные шейпы для собственно кофе, молока и пены. Строка данных шейпа определяет тип кофе. Значения выбираются из фиксированного списка. Элементы списка содержатся в ячейке Format. Каждый раз, когда пользователь выбирает значение в окне Shape Data, срабатывает функция INDEX и в ячейке Value появляется одно из значений.</p>
<p>Секция User-defined Cells содержит 5 вычисляемых переменных. Если в данный момент отвлечься от деталей формул, то можно думать о трех отдельных частях этой секции.</p>
<p><img style="width: 585px; height: 142px;" alt="user_5" src="st/stst_73_f/image006.png"><br></p>
<p>Во-первых, это ячейка CoffeeTypeIdx, в которой с помощью функции LOOKUP вычисляется порядковый номер выбранного в Shape Data значения. </p>
<p>Далее три Ratio ячейки для вычисления процентного соотношения кофе, молока и пены для выбранного типа.</p>
<p>Наконец, две Pnt ячейки для вычисления на их основе фактических координат кофе и молока в стакане.</p>
<p><img style="width: 333px; height: 101px;" alt="image 7" src="st/stst_73_f/image007.png"><br></p>
<p>При изменении значения типа кофе в данных формы уровни соответственно перемещаются вверх и вниз.</p>
<p>Хотя этот конкретный пример основан на кофе, мы видим, что в итоге просто изменяется геометрия подшейпов. Тем самым следует подчеркнуть, что можно не только хранить данные в шейпе, но и управлять его внешним видом на основе этих данных.</p>
<h2>Прочие данные</h2>
<p>Три перечисленных секции – это не полный перечень. Иногда используются более экзотические хранилища. Например, ячейки Data1…Data3, которые не доступны пользователю даже через шейп-лист. Или SolutionXML элементы, ориентированные на хранение данных в XML формате. Но они используются гораздо реже. Поэтому помнить о них полезно, но изучать лучше не в кратком обзоре, а при более глубоком знакомстве с Visio.</p>
<h2>Связывание данных с шейпами</h2>
<p>Знать способы обмена данными не менее важно, чем места хранения данных. Перейдем к двум новым возможностям, которые появились в Visio 2007: связывание данных с шейпами (Link data to Shapes) и Data Graphics.</p>
<p>Обе доступны только в выпусках Professional и выше, и об этом следует помнить, выбирая решение, предназначенное для работы во всех выпусках.</p>
<p>Начнем с первого. Исторически синхронизации данных в Visio в основном работает в одном направлении. Это подчеркивается названием встроенной функции Link data to Shapes.</p>
<p>Эта функция доступна через пользовательский интерфейс и сопутствующий API, который позволяет сопоставлять данные из ряда источников данных для формирования строк данных в шейпе.</p>
<p>Основной процесс выглядит следующим образом.</p>
<p><img style="width: 472px; height: 284px;" alt="src" src="st/stst_73_f/image008.png"><br></p>
<p>Вы выбираете источник данных. Это создает подключение к данным и объекты Datarecordset. Оба они сохраняются в документе Visio. Последний шаг - создать отношения между строками Datarecordset и строками данных шейпа в одном или нескольких шейпах.</p>
<p>Допустимо создавать несколько Datarecordset из нескольких источников. Так, например, если у нас есть первый источник SQL-сервер, вы можете добавить второй Datarecordset, подключенный к источнику Excel, и третий Datarecordset из XML-документа.</p>
<p>У XML источника данных есть особенность, заключающаяся в том, что он доступен только через код, а файл рассматривается как набор записей без установления соединения.</p>
<p>Пока мы рассматриваем одну строку данных для одного шейпа. Но возможны и другие отношения, например одну строку для многих шейпов и множество строк для одного шейпа. Последний тип отношения подпадает под ограничение - один шейп может быть связан только с одной строкой из каждого набора записей. Это, безусловно, имеет смысл, потому что Visio пытается сопоставить столбцы в Datarecordset с именованными строками данных в шейпе, и попытка сделать это более одного раза переопределит предыдущее сопоставление.</p>
<h2>Визуализация данных</h2>
<p>Теперь кратко рассмотрим Data Graphics, очень тесно связанную с Link data to Shapes. Data Graphics - это еще одна функция, которая была представлена в 2007 году и также недоступна в стандартной версии Visio.</p>
<p>Эта функция позволяет пользователям создавать дополнительные шейпы, которые можно назвать шейпами атрибутов, и динамически применять их к одному или нескольким целевым шейпам на странице.</p>
<p><img style="width: 269px; height: 246px;" alt="dg_1" src="st/stst_73_f/image009.png"><br></p>
<p>Существует набор встроенных типов, которые можно применять через пользовательский интерфейс или в коде. Также относительно просто создавать новые наборы значков для пользовательских Data Graphics.</p>
<p><img style="width: 800px; height: 355px;" alt="excel" src="st/stst_73_f/image010.png"><br></p>
<p>Рассмотрим конкретный пример связывания данных с шейпами. Пусть в той же кофейне, к которой мы уже обращались имеются данные для планирования меню. Их ведут в Excel.</p>
<p>Итак, я начну с визарда. Выберем книгу и именованный диапазон в ней.</p>
<p><img style="width: 800px; height: 510px;" alt="excel" src="st/stst_73_f/image011.png"><br></p>
<p>Затем можно отфильтровать нужные столбцы и строки, определить первичный ключ, нажать ОК и создать Datarecordset.</p>
<p><img style="width: 412px; height: 338px;" alt="DS_forms" src="st/stst_73_f/image012.png"><br></p>
<p>Существует несколько способов связывания данных. Во-первых, можно связать данные с существующим шейпом, в этом случае нужно просто перетащить строку данных и на шейп. Или можно создавать новые шейпы, перетаскивая строку или строки в свободное место на странице.</p>
<p>Выберем этот последний вариант, и мы увидим, что по мере перетаскивания строк Visio использует выбранный мастер в качестве основы для создания шейпов. К сожалению, красивого размещения не будет – это придется делать дополнительно вручную или с помощью кода.</p>
<p></p>
<p><img style="width: 800px; height: 199px;" alt="img_13" src="st/stst_73_f/image013.png"><br></p>
<p>Мы добавили шейпы и связали каждый из них с соответствующей строкой в Datarecordset. Теперь откроем шейп-лист одного из шейпов и посмотрим, что произошло в разделе данных.</p>
<p><img style="width: 800px; height: 102px;" alt="img_14" src="st/stst_73_f/image014.png"><br></p>
<p>Я изменил исходный мастер, включив в него три новых строки. В дополнение к Prop.Type добавлены Prop.CupSize, PropDescription и Prop.Price. Я специально не добавлял строку с кодом продукта, так как хотел показать, что Visio добавит в шейп строки данных, если они еще не существуют. Любые строки, добавленные таким образом, можно идентифицировать по префиксу visDM, за которым следует имя столбца из Datarecordset.</p>
<p>Еще один момент, на который следует обратить внимание, - это то, как Visio сопоставляет столбцы со строками данных шейпа через ячейку данных Label.</p>
<p>Здесь видно, что метки для описания типа, размера и цены соответствуют заголовкам соответствующих столбцов в Datarecordset. Оно может не совпадать с именем строки данных шейпа.</p>
<p>Итак, шейпы находятся на странице, а данные связаны. Теперь добавим Data Graphics для визуального отображения данных шейпа.</p>
<p><img style="width: 293px; height: 399px;" alt="img_15" src="st/stst_73_f/image015.png"><br></p>
<p>Видно, что этот Data Graphics состоят из трех элементов. Первые два относятся к текстовому типу, а третий - к гистограмме. Вы можете видеть строки данных шейпа, с которыми сопоставлены элементы, и, конечно же, при желании можете их изменить.</p>
<p><img style="width: 540px; height: 258px;" alt="img_16" src="st/stst_73_f/image016.png"><br></p>
<p>Если открыть один из элементов, то можно увидеть ряд свойств, влияющих на его внешний вид.</p>
<p><img style="width: 416px; height: 332px;" alt="img_17" src="st/stst_73_f/image017.png"><br></p>
<p>Если создать новый элемент, то видно, что существует четыре основных типа графических элементов данных. Text и Data Bar, которую вы видели, Icon Set и Color by Value.</p>
<p><img style="width: 400px; height: 181px;" alt="img_18" src="st/stst_73_f/image018.png"><br></p>
<p>Тип Color by Value отличается от других тем, что Text и Data Bar и Icon Set добавляют дополнительные шейпы рядом с основным, тогда как Color by Value фактически меняет цвет заливки.</p>
<p><img style="width: 400px; height: 332px;" alt="img_19" src="st/stst_73_f/image019.png"><br></p>
<p>Итак, это было очень краткое введение в связывание данных с фигурами и Data Graphics. Это завершает раздел Данные Visio, в котором было показано, где могут храниться данные в шейпах, как данные могут быть прочитаны и сопоставлены с шейпами, а также как можно использовать дополнительную графику на основе этих данных.</p>
<h2> Перечень литературы </h2>
<p>12.04.2019&nbsp;<b><noindex><a target = new href=https://www.universalclass.com/articles/computers/data-tools-use-to-developed-intricate-drawings-in-microsoft-visio-2016.htm
 rel="nofollow">&nbspData Tools Use to Developed Intricate Drawings in Microsoft Visio 2016</a></noindex></b>&nbsp;&nbsp;<noindex>
Universal Class
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>15.09.2014&nbsp;<b><noindex><a target = new href=/Visio/biblio/st102.htm
 rel="nofollow">&nbspСвязь с данными для профессиональных версий Visio</a></noindex></b>&nbsp;&nbsp;<noindex>
Геннадий Туманов
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>04.08.2014&nbsp;<b><noindex><a target = new href=/Visio/biblio/st103.htm
 rel="nofollow">&nbspСвязь рисунков Visio с данными</a></noindex></b>&nbsp;&nbsp;<noindex>
Геннадий Туманов
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>17.11.2011&nbsp;<b><noindex><a target = new href=https://visualsignals.typepad.co.uk/vislog/2011/11/shapes-with-global-values.html
 rel="nofollow">&nbspShapes with global values</a></noindex></b>&nbsp;&nbsp;<noindex>
John Goldsmith
&nbsp;&nbsp;</noindex>&nbsp</p>
<h2> Ответы на вопросы</h2>
<div id="menu-line">
<a href="mailto:gCroc@yandex.ru"> Gennady Tumanov </a>
</div></div></body></html>
