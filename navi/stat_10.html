<html><head>
<LINK REL="STYLESHEET" HREF="vis.css">
<title>Программирование</title>
<meta name="GENERATOR" content="MSHTML 5.00.2614.3500">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<LINK REL="STYLESHEET" HREF="../vis.css">
<link rel="icon" href="../favicon.ico" />
</head>
<body bgcolor="white">
<div class="body_div">
<table class="tft" width="100%"><tr>
<td width="15%" align="center"><a href="../index.html"><img SRC="../vl1.gif" WIDTH="177" HEIGHT="80" BORDER="0" ALT=""></a>&nbsp;</td>
<td width="5%" align="center">&nbsp;</td>
<td class='menutd' width="50%" align="center">
 <a class="menu" href="http://visio.getbb.ru/">Форум visio.getbb.ru</a> |
 <a class="menu" href="../reg.htm">О форумах</a>
<br/>
 <a class="menu" href="../bib.htm">Библиотека</a> |
 <a class="menu" href="../faq.htm">Частые вопросы</a> |
 <a class="menu" href="../bookpdf.htm">Литература</a> |
 <a class="menu" href="../loading.htm">Склад материалов</a>
<br/>
 <a class="menu" href="../navi/png_1.htm">Visio Navigator</a> |
 <a class="menu" href="../blog/">Blog</a> |
 <a class="menu" href="../inforesurs.htm">Полезные ссылки</a> |
 <a class="menu" href="../site.htm">О сайте</a>
<br/>
 <a class="menu" href="../visicorp.htm">История Visio</a> |
 <a class="menu" href="../product.htm">Продукты Visio</a>
</td>
<td width="5%" align="center">&nbsp;</td>
<td width="25%" align="center">
<script async src="https://cse.google.com/cse.js?cx=f5e9a9cb1467f4600">
</script>
<div class="gcse-search"></div>
</td></tr></table>
<table width="100%" cellpadding="0" cellspacing="0" class="min"><tr><td width="10%" align="center">&nbsp;</td>
	<td width="90%">&nbsp;&nbsp;Для русскоязычных пользователей Visio. Начинающих и профессионалов.
Где взять, как сделать, что купить и т.д.
</td></tr></table>
<!-- основной контент -->

<h1>Программирование</h1>
<p>Основой программирования в Visio является объектная модель.
В виде картинки доступна <a href="https://documentation.help/MS-Visio-Developer-Reference/OMD_online_Vis10.gif">объектная модель Visio 2002</a>.</p>
<p>В каждой новой версии обычно приводятся перечни удаленных и появившихся вновь объектов, свойств методов.</p>
<p>Обычно для каждой версии создается свой SDK (Software Development Kit), в котором можно получить наиболее точные сведения.
Адреса для загрузки:</p>
<p><a href="https://www.microsoft.com/download/details.aspx?id=36825">Visio 2013 SDK download</a></p>
<p><a href="https://www.microsoft.com/download/details.aspx?id=51221">Visio 2016 SDK download</a></p>
<h2> Перечень литературы </h2>
<p>16.02.2022&nbsp;<b><noindex><a target = new href=https://visio-tricks.gitbook.io/workspace/obektnaya-model-visio
 rel="nofollow">&nbspОбъектная модель Visio</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspнеизвестный&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>16.02.2022&nbsp;<b><noindex><a target = new href=https://github.com/MicrosoftDocs/visualstudio-docs/blob/main/docs/vsto/visio-object-model-overview.md
 rel="nofollow">&nbspVisio object model overview</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspнеизвестный&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>22.02.2021&nbsp;<b><noindex><a target = new href=https://bvisual.net/2021/02/22/using-the-callthis-function-in-visio/
 rel="nofollow">&nbspUsing the CALLTHIS function in Visio</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspDavid Parker&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>10.12.2019&nbsp;<b><noindex><a target = new href=https://www.youtube.com/playlist?list=PLt0Sv3_p1fPRQC3ZxstfXUTFrNZ9_AfNK
 rel="nofollow">&nbspплейлист VISIO+VBA: Теория</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspVigil&nbsp;</a>
&nbsp;&nbsp;</noindex>Видео&nbsp</p>
<p>10.12.2019&nbsp;<b><noindex><a target = new href=https://www.youtube.com/playlist?list=PLt0Sv3_p1fPTgTxN3KYswDTev6nWCBdcW
 rel="nofollow">&nbspплейлист VISIO+VBA: Практика</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspVigil&nbsp;</a>
&nbsp;&nbsp;</noindex>Видео&nbsp</p>
<p>07.06.2019&nbsp;<b><noindex><a target = new href=blog/11-lokalizatsiya-i-razdeliteli-v-visio.html
 rel="nofollow">&nbspЛокализация и разделители в Visio</a></noindex></b>&nbsp;&nbsp;<noindex>
Геннадий Туманов
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>31.07.2018&nbsp;<b><noindex><a target = new href=https://blog.bvisual.net/2018/07/31/enhancing-the-built-in-containers-in-visio/
 rel="nofollow">&nbspEnhancing the Built-In Containers in Visio</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspDavid Parker&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>10.12.2016&nbsp;<b><noindex><a target = new href=https://blog.bvisual.net/2016/12/10/opening-an-ms-access-form-from-a-visio-shape/
 rel="nofollow">&nbspOpening an MS Access form from a Visio shape</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspDavid Parker&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>07.07.2015&nbsp;<b><noindex><a target = new href=http://www.visguy.com/2015/07/07/deleting-visio-shapes-programmatically/
 rel="nofollow">&nbspDeleting Visio Shapes Programmatically</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspChris Roth&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>14.06.2014&nbsp;<b><noindex><a target = new href=https://docs.microsoft.com/en-us/previous-versions/office/developer/office-xp/aa163507(v=office.10)
 rel="nofollow">&nbspEmbed a Microsoft Visio Viewer 2002 Control in a Web Page</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspMicrosoft&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>14.06.2014&nbsp;<b><noindex><a target = new href=https://docs.microsoft.com/en-us/previous-versions/office/developer/office-xp/aa140282(v=office.10)
 rel="nofollow">&nbspPreventing Multiple Undo-Redo Units When Triggering an Add-on from the EventXFMod Cell in Visio 2002</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspMicrosoft&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>14.06.2014&nbsp;<b><noindex><a target = new href=https://docs.microsoft.com/en-us/previous-versions/office/developer/office-xp/aa140368(v=office.10)
 rel="nofollow">&nbspChanges in the RUNADDON Function and the AddOnName Property for Visio 2002</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspMicrosoft&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>21.05.2013&nbsp;<b><noindex><a target = new href=https://blog.bvisual.net/2013/05/21/getting-the-name-of-glued-connection-points/
 rel="nofollow">&nbspGetting the Name of Glued Connection Points</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspDavid Parker&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>28.08.2012&nbsp;<b><noindex><a target = new href=https://blog.bvisual.net/2012/08/28/checking-a-visio-shape-for-cell-errors/
 rel="nofollow">&nbspChecking a Visio Shape for Cell Errors</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspDavid Parker&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>14.03.2011&nbsp;<b><noindex><a target = new href=https://blog.bvisual.net/2011/03/14/how-to-run-vba-macros-from-a-ribbon-button-in-visio-2010/
 rel="nofollow">&nbspHow to Run VBA Macros from a Ribbon Button in Visio 2010</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspDavid Parker&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>20.04.2010&nbsp;<b><noindex><a target = new href=https://blog.bvisual.net/2010/04/20/controlling-the-pencil-mode-programmatically/
 rel="nofollow">&nbspControlling the pencil mode programmatically</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspDavid Parker&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>02.11.2009&nbsp;<b><noindex><a target = new href=https://social.technet.microsoft.com/Forums/ru-RU/92c16cd5-7834-43c5-9f55-e59725301c54/new-enumerations-for-visio-2010
 rel="nofollow">&nbspNew Enumerations for Visio 2010</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspVisimation&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>03.08.2009&nbsp;<b><noindex><a target = new href=https://blog.bvisual.net/2009/08/03/re-opening-default-stencils/
 rel="nofollow">&nbspRe-opening Default Stencils</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspDavid Parker&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>20.05.2009&nbsp;<b><noindex><a target = new href=http://www.visguy.com/2009/05/20/vba-class-property-generator/
 rel="nofollow">&nbspVBA Class Property Generator</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspChris Roth&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>17.01.2009&nbsp;<b><noindex><a target = new href=https://blog.bvisual.net/2009/01/17/visio-viewer-developer-reference-released/
 rel="nofollow">&nbspVisio Viewer Developer Reference Released</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspDavid Parker&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>25.09.2008&nbsp;<b><noindex><a target = new href=biblio/st004.htm
 rel="nofollow">&nbspПрограммирование в Visio</a></noindex></b>&nbsp;&nbsp;<noindex>
Геннадий Туманов
&nbsp;&nbsp;</noindex>Из серии статей об автоматизации. Создание первой программы в Visio. Объектная модель и способы идентификации шейпов. Пример программы получения каталога трафарета.&nbsp</p>
<p>25.09.2008&nbsp;<b><noindex><a target = new href=biblio/st002.htm
 rel="nofollow">&nbspВведение в автоматизацию Visio</a></noindex></b>&nbsp;&nbsp;<noindex>
Геннадий Туманов
&nbsp;&nbsp;</noindex>Вводная статья из запланированной серии статей о Visio и автоматизации. Определяется предметная область для данной серии, приводится предполагаемый перечень статей.&nbsp</p>
<p>17.05.2008&nbsp;<b><noindex><a target = new href=http://www.visguy.com/2008/05/17/detect-sub-selected-shapes-programmatically/
 rel="nofollow">&nbspDetect Sub-selected Shapes Programmatically</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspChris Roth&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>25.02.2008&nbsp;<b><noindex><a target = new href=http://www.visguy.com/2008/02/25/edit-visio-masters-programmaticallythe-right-way/
 rel="nofollow">&nbspEdit Visio Masters Programmatically…the Right Way!</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspChris Roth&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>01.01.2008&nbsp;<b><noindex><a target = new href=http://www.welie.com/visio/
 rel="nofollow">&nbspVisio tips & tricks for Interaction Designers</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspMartijn van Welie&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>17.05.2007&nbsp;<b><noindex><a target = new href=http://www.visguy.com/2007/05/17/vba-macro-security/
 rel="nofollow">&nbspVBA Macro Security</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspChris Roth&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>13.09.2006&nbsp;<b><noindex><a target = new href=http://www.visguy.com/2006/09/13/create-visio-flowcharts-programmatically/
 rel="nofollow">&nbspCreate Visio Flowcharts Programmatically</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspChris Roth&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>22.09.2004&nbsp;<b><noindex><a target = new href=https://surrogate-tm.github.io/mailant/2004/09/22/dev-luv-visio-development-top-five-performance-tips.htm
 rel="nofollow">&nbspVisio Development Top Five Performance Tips </a></noindex></b>&nbsp;&nbsp;<noindex>
Mai-lan
&nbsp;&nbsp;</noindex>(англ.) Пять главных советов разработчику по повышению производительности&nbsp</p>
<p>22.09.2004&nbsp;<b><noindex><a target = new href=https://surrogate-tm.github.io/mailant/2004/09/24/dev-luv-top-ten-things-to-know-when-using-the-visio-2003-activex-control.htm
 rel="nofollow">&nbspTop Ten Things to Know When Using the Visio 2003 ActiveX Control</a></noindex></b>&nbsp;&nbsp;<noindex>
Mai-lan
&nbsp;&nbsp;</noindex>(англ.) Десять основных причин использовать Visio 2003 ActiveX Control&nbsp</p>
<p>&nbsp;<b><noindex><a target = new href=https://visualsignals.typepad.co.uk/files/visioenumerations.txt
 rel="nofollow">&nbspVisio Enumerations</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspJohn Goldsmith&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<h2> Ответы на вопросы</h2>
<p class="n">Как из Visio из процедуры на VBA получить доступ к листу в книге Excel?</p>
<p class="v">Как из Visio из процедуры на VBA получить доступ к листу в книге Excel?Так же интересует обратная проблемаГенерация файла Excel из Визио&nbsp;</p>
<p class="t">Sub ReadExcel()Dim ExcelObject As ObjectSet ExcelObject = CreateObject("Excel.Application")ExcelObject.Workbooks.Add ' Добавляем новую книгуExcelObject.Workbooks.Open FileName:="C:\Work\Opis.xls" ' Открываем файлExcelObject.Visible = True ' делаем excel видимымExcelObject.Range("A1", "A1").Value = "Test:"ExcelObject.Range("A1", "A1").HorizontalAlignment = 1ExcelObject.Range("A1", "A1").VerticalAlignment = 2ExcelObject.Range("A1", "A1").WrapText = 1' ExcelObject.Quit ' для закрытия excelEnd Sub&nbsp;</p>
<p class="o">Соответственно можно только открыть какой-то файл или только создать пустую книгу. Остальные команды и форматы записи управления Excelем можно узнать используя запись макросов в самом Excel, а затем посмотрев текст в редакторе VBA.&nbsp;</p>
<p class="n">Как определить размер (длину в мм) текстовой строки?</p>
<p class="v">Подскажите, как определить размер (длину в мм) текстовой строки, а не размер шейпа в котором она написна.Нужно для функции на VBA.&nbsp;</p>
<p class="o">На основе примера из документации:&nbsp;</p>
<p class="t">Sub Text_width()Dim shpObj As Visio.ShapeSet pagsObj = ThisDocument.PagesSet pagObj = pagsObj.Item(1)Set selectObj = ActiveWindow.SelectionSet shpObj = ActiveWindow.Selection.Item(1)shpObj.Text = "Text here" 'пишем текст в фигуру или оставляемshpObj.AddSection visSectionUser 'добавляем разделshpObj.AddRow visSectionUser, visRowUser + 0, 0 'добавляем строкуSet celObj = shpObj.Cells("User.Row_1") 'назначаем ячейкуcelObj.Formula = "TEXTWIDTH(TheText)" 'забиваем формулуTextWTH = celObj.Result(visMillimeters) 'забираем результатMsgBox TextWTH, , "Text width" 'показываем результатEnd Sub&nbsp;</p>
<p class="n">Как из скрипта можно установить единицу измерения?</p>
<p class="v">Есть какая то заморочка с дюймами... вообще хочу работать с см, поэтому меняю для странички в Page setup inches на cm все вроде ок..Потом, при расстановке фигур по страничке не могу разобраться в чем идет расчет, например:elements(0).SetBegin x / 2.54, (2 + Kcell_total(0) / step) / 4.54при значении Kcell_total(0)=4241, x=2 начало получается расположенным в точке (2;4,5) - каким образом.... не могу понять и попутно как из скрипта можно установить единицу измерения для pages или для page..&nbsp;</p>
<p class="o">Единица измерения переключается масштабом&nbsp;</p>
<p class="t"> ActivePage.PageSheet.Cells("PageScale").Formula = "1 cm" ActivePage.PageSheet.Cells("DrawingScale").Formula = "1 cm"&nbsp;</p>
<p class="o">переведет в см, а&nbsp;</p>
<p class="t"> ActivePage.PageSheet.Cells("PageScale").Formula = "1 in" ActivePage.PageSheet.Cells("DrawingScale").Formula = "1 in"&nbsp;</p>
<p class="o">переключит в дюймы.Но вводите данные Вы все равно в дюймах, поэтому (2дюйма)/2.54 дает 2 см и отстоит на 2 клеточки от края листа, если единицу измерения установили см. (по Y Вы не сообщили значение step).Короче, видеть Вы будете в см, а вводить в дюймах.&nbsp;</p>
<div id="menu-line">
<a href="mailto:gCroc@yandex.ru"> Gennady Tumanov </a>
</div></div></body></html>
