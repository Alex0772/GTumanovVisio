<html><head>
<LINK REL="STYLESHEET" HREF="vis.css">
<title>Отчеты</title>
<meta name="GENERATOR" content="MSHTML 5.00.2614.3500">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<LINK REL="STYLESHEET" HREF="../vis.css">
<link rel="icon" href="../favicon.ico" />
</head>
<body bgcolor="white">
<div class="body_div">
<table class="tft" width="100%"><tr>
<td width="15%" align="center"><a href="../index.html"><img SRC="../vl1.gif" WIDTH="177" HEIGHT="80" BORDER="0" ALT=""></a>&nbsp;</td>
<td width="5%" align="center">&nbsp;</td>
<td class='menutd' width="50%" align="center">
 <a class="menu" href="http://visio.getbb.ru/">Форум visio.getbb.ru</a> |
 <a class="menu" href="../reg.htm">О форумах</a>
<br/>
 <a class="menu" href="../bib.htm">Библиотека</a> |
 <a class="menu" href="../faq.htm">Частые вопросы</a> |
 <a class="menu" href="../bookpdf.htm">Литература</a> |
 <a class="menu" href="../loading.htm">Склад материалов</a>
<br/>
 <a class="menu" href="../navi/png_1.htm">Visio Navigator</a> |
 <a class="menu" href="../blog/">Blog</a> |
 <a class="menu" href="../inforesurs.htm">Полезные ссылки</a> |
 <a class="menu" href="../site.htm">О сайте</a>
<br/>
 <a class="menu" href="../visicorp.htm">История Visio</a> |
 <a class="menu" href="../product.htm">Продукты Visio</a>
</td>
<td width="5%" align="center">&nbsp;</td>
<td width="25%" align="center">
<script async src="https://cse.google.com/cse.js?cx=f5e9a9cb1467f4600">
</script>
<div class="gcse-search"></div>
</td></tr></table>
<table width="100%" cellpadding="0" cellspacing="0" class="min"><tr><td width="10%" align="center">&nbsp;</td>
	<td width="90%">&nbsp;&nbsp;Для русскоязычных пользователей Visio. Начинающих и профессионалов.
Где взять, как сделать, что купить и т.д.
</td></tr></table>
<!-- основной контент -->

<h1>Отчеты</h1>
<p>Отчеты - важный инструмент Visio, позволяющий быстро выбрать и оформить данные, находящиеся в документе Visio, в виде таблицы на поле документа или отдельного файла.</p>
<p>Подготовка, сохранение и запуск отчетов с помощью встроенного формирователя отчетов (мастера или визарда) описаны в справке и статьях blogs.technet.microsoft.com (О Visio по-русски).</p>
<p>Хороший пример использования отчетов приводит David J Parker в статье Changing Embedded Visio Report Column Headers. Показано, как возможность сортировки шейпов по X и Y позволяет получить отчет, сгруппированный по стойкам и отсортированный по вертикальному расположению приборов. Более того, приведена ссылка на дополнительные макросы, дающие возможность переименовать колонки в отчете.</p>
<p>Информация, необходимая для программного выполнения отчетов приведена в статье <a href="https://visioport.ru/blog/index.php/2-otchety-visio">Отчеты Visio</a> Геннадия Туманова</p>
<p>Еще один интересный способ получения отчетов из документов Visio показан в статье <a href="https://visioport.ru/blog/index.php/8-iz-visio-v-excel-cherez-power-query">Из Visio в Excel через Power Query</a>. Способ основан на прямой выборке данных из файла Visio в табличной форме. Запросы Power Query работают напрямую с документом и не требуют наличия установленного Visio. Способ позволяет свести в одну таблицу данные нескольких страниц Visio.</p>

<h2> Перечень литературы </h2>
<p>30.08.2022&nbsp;<b><noindex><a target = new href=https://bvisual.net/2022/08/30/visio-shape-report-converter-excel-add-in-available/
 rel="nofollow">&nbspVisio Shape Report Converter Excel add-in available</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspDavid Parker&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>11.01.2022&nbsp;<b><noindex><a target = new href=https://johnvisiomvp.ca/2022/01/11/a-few-words-of-encouragement/
 rel="nofollow">&nbspA few Words of encouragement</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspjohnvisiomvp&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>20.03.2019&nbsp;<b><noindex><a target = new href=/Visio/blog/8-iz-visio-v-excel-cherez-power-query.html
 rel="nofollow">&nbspИз Visio в Excel через Power Query</a></noindex></b>&nbsp;&nbsp;<noindex>
Геннадий Туманов
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>28.12.2018&nbsp;<b><noindex><a target = new href=/Visio/blog/2-otchety-visio.html
 rel="nofollow">&nbspОтчеты Visio</a></noindex></b>&nbsp;&nbsp;<noindex>
Геннадий Туманов
&nbsp;&nbsp;</noindex>Структура описания отчета, программный вызов, ключи.&nbsp</p>
<p>10.06.2015&nbsp;<b><noindex><a target = new href=https://blogs.technet.microsoft.com/visio_ru/2015/06/10/3881/
 rel="nofollow">&nbspИзменение существующего отчета</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspAlla Vasilieva&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>13.08.2013&nbsp;<b><noindex><a target = new href=https://blogs.technet.microsoft.com/visio_ru/2013/08/13/684/
 rel="nofollow">&nbspВыполнение предопределенного отчета в Visio</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspAlla Vasilieva&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>13.09.2012&nbsp;<b><noindex><a target = new href=https://blogs.technet.microsoft.com/visio_ru/2012/09/13/427/
 rel="nofollow">&nbspВыполнение предопределенного отчета</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspAlla Vasilieva&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>31.08.2012&nbsp;<b><noindex><a target = new href=https://blogs.technet.microsoft.com/visio_ru/2012/08/31/404/
 rel="nofollow">&nbspСоздание нового отчета</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspAlla Vasilieva&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>31.07.2011&nbsp;<b><noindex><a target = new href=https://blog.bvisual.net/2011/07/31/changing-embedded-visio-report-column-headers/
 rel="nofollow">&nbspChanging Embedded Visio Report Column Headers</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspDavid Parker&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>15.10.2006&nbsp;<b><noindex><a target = new href=https://blogs.msmvps.com/visio/2006/10/15/visios-other-file-format-report-definition-files-vrd/
 rel="nofollow">&nbspVisio's other file format – Report Definition files</a></noindex></b>&nbsp;&nbsp;<noindex>
John Marshall
&nbsp;&nbsp;</noindex>Краткое описание формата .vrd&nbsp</p>
<h2> Ответы на вопросы</h2>
<p class="n">Сортировка в отчете</p>
<p class="v">Пытаюсь в отчете сделать сортировку по данным в фигуре например это номер , в отчете сортировка идет таким образом 1,10,11..,2,3 и так далее. А можно ли сделать , чтобы было по порядку то есть 1,2,3,4,10,11 ну и так далее?&nbsp;</p>
<p class="o">Это нормальная сортировка для текста. Попробуйте сделать поле не String, а Number. Так как отчет вытаскивает тип поля из свойства шейпа, то в новом определении отчета будет уже не Type=0, а Type=2.Второй путь - вместо штатного отчета сделать все макросом. В этом случае свободы гораздо больше. В том числе и по преобразованию типов и форматированию результатов.&nbsp;</p>
<p class="n">Отчет о фигурах сгруппированной фигуры с текстовым полем</p>
<p class="v">С толкнулся с такой проблемой, если внутри фигуры есть фигуры с вставленным текстовым полем и если у такой фигуры в поведение стоит сначала группа или сначала компоненты, то при отчете о фигурах будет отчет по всем фигурам внутри фигуры с вставленным полем. Можно ли это исправить, чтобы в отчете была информация только о группе без фигур входящих в ее состав и при этом поведение было сначала группа или сначала компоненты?&nbsp;</p>
<p class="o">Два варианта:1 - отфильтровать отчет по слою или по имени мастер-шейпа.2 - снять в поведении группы галочку Edit text of group.&nbsp;</p>
<p class="n">Отображение большого числа в отчете фигур</p>
<p class="v">Столкнулся с такой проблемой, что в отчете о фигурах числовые артикулы отображаются, как экспоненциальное число , например число "4680019910512" в отчете "4,68002E+12". Можно ли сделать, чтобы число показывалось сразу просто числом?&nbsp;</p>
<p class="o">Такое впечатление, что здесь работает нечто, заимствованное из Excel. И оно просто не состыковалось с Visio. Но в Excel для принудительного указания на строку можно перед числом поставить апостроф. И Excel будет отображать только цифры, но считать это уже строкой, а не числом.Этот же прием проходит и в данном случае. То есть, если в Prop.Article записать '4680019910512, то в отчете это будет отображено как 4680019910512 без апострофа и без экспонент.&nbsp;</p>
<p class="n">Подсчёт свойств шейпа</p>
<p class="v">Цель: есть схема на которой расставлены "стеллажи", прямоугольные шейпы со свойствами "название" "размер" "количество"(иногда размеров может быть 2), шейпы генерятся автоматически, потом на схеме расставляются в ручную. задача пересчитать, одинаковые просуммировать, и результат вывести.Нашел код, который пересчитывает "верхние"(сгруппированные) шейпы, разгруппировать не проблема, но я не понимаю как вытащить свойства из шейпа.&nbsp;</p>
<p class="o">Свойства вытаскиваются из ячеек шейп-листа. Все ячейки имеют имена. Пример&nbsp;</p>
<p class="t">Set vsoCell = vsoShape.Cells("LocPinX")intLocalCenterX = vsoCell.Result("cm")&nbsp;</p>
<p class="o">Если известен шейп vsoShape и имя ячейки, например LocPinX, то первая строка примера получает объект "ячейка" vsoCell. А вторая строка из свойства Result этой ячейки берет значение в сантиметрах.То есть ищите имя нужной ячейки и смотрите справку по поводу свойств Result, ResultInt, ResultStr и подобных.Кстати, возможно будет проще вытаскивать данные не с помощью VBA, а с помощью отчетов. Это уже надо смотреть конкретный документ и что из него получится вытащить.Пример кода и отчетов смотреть в первоисточнике - http://visio.getbb.ru/viewtopic.php?f=6&t=1737&p=16301&nbsp;</p>
<p class="n">Проблема с импортом данных фигуры в файл Excel</p>
<p class="v">Друзья, помогите, пожалуйста, разобраться с выгрузкой данных фигуры из visio в файл Excel. В visio в текстовое поле данных можно сохранять любое количество символов. Но при использовании надстройки "Дополнительные решения visio -> Мастер экспорта баз данных" в Excel выгружаются только первые 255 символов, а остальные данные теряются. Можно ли как-то увеличить количество выгружаемых символов?&nbsp;</p>
<p class="o">Первое, что я попробовал - вывести данные в отчет в Excel. 400 знаков выводятся нормально, далее не смотрел. Такой вариант не устроит?Второй вариант - вывести через тот же мастер экспорта, но сначала в Access, а уже из него - в Excel. Так тоже длинные поля выводятся.&nbsp;</p>
<div id="menu-line">
<a href="mailto:gCroc@yandex.ru"> Gennady Tumanov </a>
</div></div></body></html>
