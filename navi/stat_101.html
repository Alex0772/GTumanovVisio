<html><head>
<LINK REL="STYLESHEET" HREF="vis.css">
<title>подпись кода</title>
<meta name="GENERATOR" content="MSHTML 5.00.2614.3500">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<LINK REL="STYLESHEET" HREF="../vis.css">
<link rel="icon" href="../favicon.ico" />
</head>
<body bgcolor="white">
<div class="body_div">
<table class="tft" width="100%"><tr>
<td width="15%" align="center"><a href="../index.html"><img SRC="../vl1.gif" WIDTH="177" HEIGHT="80" BORDER="0" ALT=""></a>&nbsp;</td>
<td width="5%" align="center">&nbsp;</td>
<td class='menutd' width="50%" align="center">
 <a class="menu" href="http://visio.getbb.ru/">Форум visio.getbb.ru</a> |
 <a class="menu" href="../reg.htm">О форумах</a>
<br/>
 <a class="menu" href="../bib.htm">Библиотека</a> |
 <a class="menu" href="../faq.htm">Частые вопросы</a> |
 <a class="menu" href="../bookpdf.htm">Литература</a> |
 <a class="menu" href="../loading.htm">Склад материалов</a>
<br/>
 <a class="menu" href="../navi/png_1.htm">Visio Navigator</a> |
 <a class="menu" href="../blog/">Blog</a> |
 <a class="menu" href="../inforesurs.htm">Полезные ссылки</a> |
 <a class="menu" href="../site.htm">О сайте</a>
<br/>
 <a class="menu" href="../visicorp.htm">История Visio</a> |
 <a class="menu" href="../product.htm">Продукты Visio</a>
</td>
<td width="5%" align="center">&nbsp;</td>
<td width="25%" align="center">
<script async src="https://cse.google.com/cse.js?cx=f5e9a9cb1467f4600">
</script>
<div class="gcse-search"></div>
</td></tr></table>
<table width="100%" cellpadding="0" cellspacing="0" class="min"><tr><td width="10%" align="center">&nbsp;</td>
	<td width="90%">&nbsp;&nbsp;Для русскоязычных пользователей Visio. Начинающих и профессионалов.
Где взять, как сделать, что купить и т.д.
</td></tr></table>
<!-- основной контент -->

<h1>подпись кода</h1>
<p>Когда делаешь что-то для себя, вопрос с подписью кода не возникает. Написал макрос, установил разрешение для запуска макросов и больше можно ни о чем не думать.</p>
<p>Совсем другое дело, если нужно передать результат разработки другим пользователям. Здесь уже вопросы безопасности, доверия к издателю и т.д. поднимаются в полный рост. А если учесть, что официальный сертификат стоит довольно дорого, то полпись кода становится проблемой. Особенно когда разработкой занимаешься время от времени.</p>
<p>Однако нужно помнить, что сертификат для подписи кода можно получить не только в центрах сертификации (таких как Thawte, Comodo, Digicert...), но и выпустить самому. И работать такие сертификаты будут ничуть не хуже, по крайней мере в рамках одной организации. Весь вопрос в том, как организовать цепочку к корневому сертификату. Для изучения этого вопроса будут полезны такие статьи как "How to create your own code signing certificate and sign an ActiveX component in Windows" и "Self-Signed Certificate and Outlook VSTO Add-in Silent Installation".</p>
<p>Кроме того, нужно помнить, что заказчик (пользователь) имеет возможность переподписать приложение, то есть заверить его собственным сертификатом. В некоторых случаях это тоже является выходом.</p>
<h2> Перечень литературы </h2>
<p>18.03.2021&nbsp;<b><noindex><a target = new href=https://developer.microsoft.com/en-us/sharepoint/blogs/upgrade-signed-office-vba-macro-projects-to-v3-signature/
 rel="nofollow">&nbspUpgrade signed Office VBA macro projects to V3 signature</a></noindex></b>&nbsp;&nbsp;<noindex>
Yu Kaijun
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>02.10.2012&nbsp;<b><noindex><a target = new href=https://habr.com/company/tuthost/blog/152867/
 rel="nofollow">&nbspCode Signing сертификаты или сертификаты разработчика. Виды, как выбрать</a></noindex></b>&nbsp;&nbsp;<noindex>
s0laris
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>29.12.2011&nbsp;<b><noindex><a target = new href=https://diamantico.wordpress.com/2011/12/29/how-to-create-your-own-code-signing-certificate-and-sign-an-activex-component-in-windows/
 rel="nofollow">&nbspHow to create your own code signing certificate and sign an ActiveX component in Windows</a></noindex></b>&nbsp;&nbsp;<noindex>
diamantico
&nbsp;&nbsp;</noindex>Как создать свой сертификат и подписать ActiveX в Windows&nbsp</p>
<p>27.01.2009&nbsp;<b><noindex><a target = new href=https://blogs.msdn.microsoft.com/rextang/2009/01/27/self-signed-certificate-and-outlook-vsto-add-in-silent-installation/
 rel="nofollow">&nbspSelf-Signed Certificate and Outlook VSTO Add-in Silent Installation</a></noindex></b>&nbsp;&nbsp;<noindex>
Rex Tang
&nbsp;&nbsp;</noindex>Самоподписанный сертификат и автоматическая установка Add-in для Outlook&nbsp</p>
<h2> Ответы на вопросы</h2>
<p class="n">Требуется помощь с сертификатами</p>
<p class="v">У меня есть документ Visio с макросами VBA. Каждый раз, когда он открывается, пользователь должен щелкнуть -> enable the macros.Есть ли способ:а. установить автоматическое включение макросов в документе?б. автоматически установить низкий уровень безопасности в документе?Или в этом случае мне нужна цифровая подпись или сертификат для включения макросов без нажатия пользователем кнопки. Легко ли его получить?&nbsp;</p>
<p class="o">Автоматическое включение макросов через документ невозможно, потому что это именно то действие, против которого была разработана эта защита. То есть а) и б) невозможны.Вы можете попросить своих пользователей переместить ваш документ в "trusted location", возможно, это самое простое:http://office.microsoft.com/en-001/visio-help/create-remove-or-change-a-trusted-location-for-your-files-HA010031999.aspxВы также можете указать своим пользователям отключить эту защиту на уровне приложения. Это можно сделать в настройках приложения.Чтобы открыть документ с макросами с настройками безопасности Visio по умолчанию  без лишних запросов - да, вам нужен сертификат для подписи этого документа.Если у вас есть только один пользователь, то вы можете самостоятельно создать "самоподписанный" сертификат на компьютере этого пользователя и подписать свой документ этим сертификатом, или ваш пользователь может сделать это сам. Это позволит открыть ваши документы без запроса безопасности.Вы также можете создать "самоподписанный" сертификат и попросить своих пользователей установить его как "доверенный корневой центр сертификации" на своем компьютере (обратите внимание, что создание таких доверенных корней, вероятно, не очень хорошо с точки зрения безопасности).Получение настоящего сертификата не очень сложно (но стоит денег). Вы можете получить либо личный сертификат, либо сертификат компании (для второго варианта вам, конечно, понадобится компания).Чтобы получить личный сертификат, вам необходимо связаться с центром сертификации и подтвердить свою личность, что обычно включает отправку (по электронной почте) скана вашего паспорта / водительских прав, скана вашего последнего счета за телефон / электричество или тому подобного (чтобы они могли доказать где вы живете), и ваш номер телефона - (чтобы они могли перезвонить вам, чтобы проверить это). Обратите внимание, что сертификат будет выдан на точно ваше имя.Если вы представляете компанию, данные, которые вы должны будете предоставить, зависят от страны, в которой вы находитесь (в разных странах существует разная система регистрации компаний, но в основном вас попросят предоставить своего рода "запись торгового реестра")Я мог бы порекомендовать http://startssl.com (недавно обновил свой сертификат за 1 день). Двухлетний код подписи личного сертификата стоил 60 долларов.Обратите внимание, что при подписании документов Visio вы должны настроить источник для отметки времени. Это сделано как параметр реестра. Если этого не сделать, срок действия подписи истекает после истечения срока действия сертификата.&nbsp;</p>
<p class="t">reg file:Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\Software\Microsoft\VBA\Security]"TimeStampURL"="http://timestamp.verisign.com/scripts/timstamp.dll""TimeStampRetryCount"=dword:00000002"TimeStampRetryDelay"=dword:00000002&nbsp;</p>
<p class="o">(Источник - http://visguy.com/vgforum/index.php?topic=4882.msg19179#msg19179).&nbsp;</p>
<p class="n">При подписывании манифеста определяется Invalid provider</p>
<p class="v">Я создаю новую надстройку в VS2015, выполняю сборку, но получаю ошибку: error MSB3482: An error occurred while signing: Invalid provider type specified.Я использую 64-разрядную версию Windows 7, 64-разрядную версию Visio 2016 Pro. Я думаю, что речь идет о подписи clickonce манифеста, и пытался сделать разные сертификаты, но все же не повезло. У кого-нибудь встречалась такая же проблема?&nbsp;</p>
<p class="o">Не совсем понятно, что вы подразумеваете под "сборкой". Просто собрать (скомпилировать) или собрать, а затем опубликовать?Прямо из коробки компиляция должна просто работать без какого-либо сертификата (то есть, когда вы создаете новый проект и нажимаете F5 в Visual Studio)Если вы просто создаете надстройку проекта, вам не нужен сертификат.Удалите все подписи из проекта, VS отлично сделает все сам.Если вы хотите опубликовать надстройку (нажав "Опубликовать..."), вам нужен действующий сертификат SHA2 (сертификаты SHA1 уже запрещены).Обратите внимание, что все сертификаты, выданные за последние 2 года, являются сертификатами SHA2 - власти больше не выдают SHA1.Поэтому, если вы попытаетесь опубликовать, используя старый сертификат (например, предоставленный вам компанией), вы можете столкнуться с чем-то вроде описанной вами ошибки.(Источник - http://visguy.com/vgforum/index.php?topic=8333.msg36037#msg36037)&nbsp;</p>
<p class="n">Как установить Timestamp?</p>
<p class="v">Если вы приобрели сертификат для подписи кода, вы можете использовать его для подписи макросов в ваших документах, трафаретах, шаблонах, а также для подписи exe, dll и vsl файлов. Для документов, трафаретов, шаблонов это делается через меню Tools -> Digital Signature в редакторе VBA.Все это прекрасно работает в течение года, пока не истечет срок действия вашего сертификата, после чего весь код, который вы разослали своим клиентам по всему миру, внезапно выдает ошибки безопасности, поскольку подпись больше не действительна. Ничто в редакторе VBA не говорит вам об этом, на самом деле очень трудно найти какую-либо ссылку на это, это почти так, как если бы кто-то, кто разрабатывал процесс подписания макросов, делал это нарочно.Все, что вам нужно сделать, это добавить такую запись в ваш реестр:&nbsp;</p>
<p class="t">[HKEY_CURRENT_USER\Software\Microsoft\VBA\Security]"TimeStampUrl"="http://timestamp.verisign.com/scripts/timstamp.dll""TimeStampRetryCount"=dword:00000003"TimeStampRetryDelay"=dword:0000001e&nbsp;</p>
<p class="v">с соответствующими дополнениями, чтобы подтвердить ваши права подписи.С этой информацией, вы можете избежать нанесения ущерба репутации вашего бизнеса.&nbsp;</p>
<p class="o">(Источник - http://visguy.com/vgforum/index.php?topic=1090.msg4764#msg4764)&nbsp;</p>
<p class="n">Где купить сертификат для подписи макросов в трафарете?</p>
<p class="v">Я планирую продавать свои трафареты с макросами VBA. Кто-нибудь покупал цифровые подписи? Не могли бы вы поделиться своим опытом и знаниями?Моя цель - убедить своих клиентов в том, что продукт безопасен. Затраты на покупку у доверенных партнеров MS, похоже, побеждают любую прибыль, которую я рассчитываю получить.&nbsp;</p>
<p class="o">Я использую http://codesigning.ksoftware.net/ и вполне доволен.Я мог бы рекомендовать этот: http://startssl.com/ - почти в три раза дешевле.(2 класс - 60 долларов за 2 года). Это нормально для подписи для макроса / exe / setup.Обратите внимание, что есть небольшая загвоздка - если клиент не запускал обновление Windows в течение 3 лет, этот сертификат не будет работать (они не так давно получили полномочия root).Помните, что только если вам нужен WinQUAL (например, чтобы иметь возможность получать аварийные дампы вашей программы с серверов Microsoft) или, например, Если вы хотите получить драйвер устройства или пройти сертификацию Windows, вы должны обратиться в VeriSign / GlobalSign. (На самом деле, вы все еще можете купить его сейчас за $ 100 / год у VeriSign (сейчас у Symantec). Ссылка на покупку за $100 вместо $500 все еще присутствует на сайте VeriSign, их просто очень трудно найти).Оказывается, у дешевых сертификатов StartSLL (60 долларов на 2 года) есть ограничение.Срок действия подписи истекает по истечении срока действия сертификата, даже если подписанный двоичный файл / макрос имеет временную метку. То есть обычно срок действия подписи не истекает, когда истекает срок действия сертификата, если он был действителен на момент подписания; это не относится к (обычным) сертификатам StartSLL (для них установлен специальный флаг в сертификате).(Источник - http://visguy.com/vgforum/index.php?topic=4403.msg20059#msg20059)&nbsp;</p>
<div id="menu-line">
<a href="mailto:gCroc@yandex.ru"> Gennady Tumanov </a>
</div></div></body></html>
