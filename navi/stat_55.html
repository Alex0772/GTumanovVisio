<html><head>
<LINK REL="STYLESHEET" HREF="vis.css">
<title>Вставка полей</title>
<meta name="GENERATOR" content="MSHTML 5.00.2614.3500">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<LINK REL="STYLESHEET" HREF="../vis.css">
<link rel="icon" href="../favicon.ico" />
</head>
<body bgcolor="white">
<div class="body_div">
<table class="tft" width="100%"><tr>
<td width="15%" align="center"><a href="../index.html"><img SRC="../vl1.gif" WIDTH="177" HEIGHT="80" BORDER="0" ALT=""></a>&nbsp;</td>
<td width="5%" align="center">&nbsp;</td>
<td class='menutd' width="50%" align="center">
 <a class="menu" href="http://visio.getbb.ru/">Форум visio.getbb.ru</a> |
 <a class="menu" href="../reg.htm">О форумах</a>
<br/>
 <a class="menu" href="../bib.htm">Библиотека</a> |
 <a class="menu" href="../faq.htm">Частые вопросы</a> |
 <a class="menu" href="../bookpdf.htm">Литература</a> |
 <a class="menu" href="../loading.htm">Склад материалов</a>
<br/>
 <a class="menu" href="../navi/png_1.htm">Visio Navigator</a> |
 <a class="menu" href="../blog/">Blog</a> |
 <a class="menu" href="../inforesurs.htm">Полезные ссылки</a> |
 <a class="menu" href="../site.htm">О сайте</a>
<br/>
 <a class="menu" href="../visicorp.htm">История Visio</a> |
 <a class="menu" href="../product.htm">Продукты Visio</a>
</td>
<td width="5%" align="center">&nbsp;</td>
<td width="25%" align="center">
<script async src="https://cse.google.com/cse.js?cx=f5e9a9cb1467f4600">
</script>
<div class="gcse-search"></div>
</td></tr></table>
<table width="100%" cellpadding="0" cellspacing="0" class="min"><tr><td width="10%" align="center">&nbsp;</td>
	<td width="90%">&nbsp;&nbsp;Для русскоязычных пользователей Visio. Начинающих и профессионалов.
Где взять, как сделать, что купить и т.д.
</td></tr></table>
<!-- основной контент -->

<h1>Вставка полей</h1>
<p>Шейпы часто содержат текст. В простейшем случае он сохранен в шейпе в виде строки, так сказать, константа.
Но помимо этого существует механизм для отображения данных в виде текста. Это так называемые поля.
Поля действуют аналогично переменным - если изменяются данные, то тут же автоматически изменяется и текст шейпа.</p>
<p>Существует специальное диалоговое окно для вставки полей, открывающеся через меню Insert / Field,
и предлагающее для вставки наиболее распространенные типы (категории) данных:</p>
<p>Shape Data</p>
<p>Date/Time</p>
<p>Document Info</p>
<p>Page Info</p>
<p>Geometry</p>
<p>Object Info</p>
<p>User-defined Cells
<p>Custom Formula</p>
<p>Потом категории могут быть раскрыты до имен полей. Причем перечень полей зависит от шейпа.
Например, если у шейпа нет секции Shape Data, то и категория Shape Data будет пустой.</p>
<p>Помимо категорий, которые используются как заготовки, существует еще и Custom Formula,
позволяющая использовать в качестве источника данных любую ячейку шейп-листа этого же шейпа,
другого шейпа, комбинацию нескольких источников и т.д. Лишь бы итоговая формула подчинялась
правилам работы с формулами шейп-листа.</p>
<p>Находясь в режиме редактирования текста, можно последовательно вставить в шейп несколько полей. Используя символы
табуляции и перевода строки, поля можно разнести по разным сторонам шейпа, разместить их в несколько строк и даже повернуть отдельные поля.
Вот на этой картинке показан один шейп, отражающий три поля категории Geometry.</p>
<IMG SRC="stat_55_f/fields.gif" WIDTH="447" HEIGHT="261" BORDER="0" ALT="">
<p>Нужно помнить, что при использовании полей появляется некоторая специфика форматирования текста шейпов или
программной работы с текстом таких шейпов. Например, нельзя половину поля выделить жирным шрифтом,
только все поле целиком. Или при программном чтении текст уже не удается прочитать как Shape.Text, а только как Shape.Characters.Text.</p>

<h2> Перечень литературы </h2>
<p>06.12.2019&nbsp;<b><noindex><a target = new href=https://bvisual.net/2019/12/06/displaying-visio-number-shapes-data-clearly/
 rel="nofollow">&nbspDisplaying Visio Number Shapes data clearly</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspDavid Parker&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>17.10.2019&nbsp;<b><noindex><a target = new href=/Visio/blog/17-funktsiya-filename-i-vse-takoe.html
 rel="nofollow">&nbspФункция FILENAME() и все такое</a></noindex></b>&nbsp;&nbsp;<noindex>
Геннадий Туманов
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>06.06.2018&nbsp;<b><noindex><a target = new href=https://rus-visio-blog-archive.github.io/2018/06/06/fields.htm
 rel="nofollow">&nbspПрименение полей в MS Visio</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspKuzin Alexander&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>17.04.2014&nbsp;<b><noindex><a target = new href=http://guides.wmlcloud.com/office/Developing-Custom-Microsoft-Visio-2010-Solutions---Creating-SmartShapes-with-the-ShapeSheet-(part-4)---Linking-Subshape-Text-to-Shape-Data-Fields.aspx
 rel="nofollow">&nbspLinking Subshape Text to Shape Data Fields</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspMicrosoft&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>11.07.2012&nbsp;<b><noindex><a target = new href=https://blogs.technet.microsoft.com/visio_ru/2012/07/11/344/
 rel="nofollow">&nbspИспользование информационных данных фигур и основные приемы вставки полей</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspAlla Vasilieva&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>01.01.2007&nbsp;<b><noindex><a target = new href=https://support.office.com/ru-ru/article/%D0%92%D1%81%D1%82%D0%B0%D0%B2%D0%BA%D0%B0-%D1%82%D0%B5%D0%BA%D1%81%D1%82%D0%BE%D0%B2%D0%BE%D0%B3%D0%BE-%D0%BF%D0%BE%D0%BB%D1%8F-%D0%B2-%D1%84%D0%B8%D0%B3%D1%83%D1%80%D1%83-0225c22e-3e5e-4ea7-9ca0-1ec91386cb1e
 rel="nofollow">&nbspВставка текстового поля в фигуру</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspMicrosoft&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<h2> Ответы на вопросы</h2>
<p class="n">Несколько Text Fields для фигуры в группе</p>
<p class="v">Часто нужно добавить к фигуре несколько текстовых полей. Так вот если фигура отдельно - проблемы нет. добавил поле. потом двойным кликом открыл текст на редактирование - добавил еще поле. все по справке. а вот если фигура состоит в группе? Текст тогда на редактирование не открывается - двойной клик переставляет выделение с фигуры на группу. как добавить несколько полей в этом случае ? можно конечно создать поля заранее и внести фигуру в группу, но это несколько коряво имхо. &nbsp;</p>
<p class="o">Группу можно открыть на редактирование (через меню Edit). Она открывается и ведет себя, как отдельный документ.&nbsp;</p>
<p class="v">ок. а если надпись принадлежит шейпу-группе который тоже входит в группу? осн. то можно открыть - а вот дальше? Двойной клик управляет выделением, открывать группу на редактирование бесполезно... как до текста добратся ?&nbsp;</p>
<p class="o">В общем-то, двойной клик - это для ленивых...А основной способ - это инструмент Text Tool. (Такой с буковкой "А").Селектируйте группу и щелкайте по нему.&nbsp;</p>
<p class="v">то что надо, спасибо&nbsp;</p>
<p class="n">Текстовые поля</p>
<p class="v">Подскажите, как вставить несколько текстовых полей в одну фигуруУточняю: в ShapeSheet фигур есть секция Поля Текста (ТехтFields). У некоторых Master из стандартных Stencils в этой секции может быть несколько строк, т.е. несколько полей. Я могу вставить в любую фигуру ОДНО поле любой категории, могу изменить это поле через меню или через ShapeSheet, но не могу добавить еще одно, например, добавляя строки в секцию, как это можно сделать в других секциях типа Геометрии или Connection Points. Так конкретнее?&nbsp;</p>
<p class="o">Вставка таких текстовых полей осуществляется так:1) Выделить фигуру.2) Нажать F2 (открываем текстовый блок для редактирования)3) Нажать правой кнопкой мыши.4) Выбрать Вставка поля(Insert Field)Далее откроется окно выбора, откуда брать данные, которые буду отображаться в этом поле. Соответственно повтор действий даст 2 текстовых поля в текстовом блоке...&nbsp;</p>
<p class="n">Значение текстового поля</p>
<p class="v">К примеру есть два текстовых поля Sheet.1 и Sheet.2, как записать Costum Formula для Sheet.2 что его текст = тексту Sheet.1?&nbsp;</p>
<p class="o">=Sheet.2!Fields.Valueгде sheet.2 - имя шейпав шейплисте Sheet.2 должна быть секция Text FieldsЕсли текстовых полей несколько, то номер строки указывается в квадратных скобках. Например, =Sheet.2!Fields.Value[3] - ссылка на третье поле.&nbsp;</p>
<p class="n">Как программно вставить поле в Text Fields?</p>
<p class="v">Как программно реализовать, то что мы получаем при выполнении операции Insert->Field?Вот такой код:&nbsp;</p>
<p class="t">visObj.ActivePage.Shapes(i).AddSection (visSectionTextField)v = visObj.ActivePage.Shapes(i).AddRow(visSectionTextField, visRowField, 0)visObj.ActivePage.Shapes(i).Shapes(i1).CellsSRC(visSectionTextField, v, visFieldFormat).Formula = "FieldPicture(37)"visObj.ActivePage.Shapes(i).Shapes(i1).CellsSRC(visSectionTextField, v, visFieldValue).Formula = "ThePage!Prop.Row_1"&nbsp;</p>
<p class="v">работает, добавляется секция и строка, и данные в строку прописываются, только в шейпе текст который находится в "ThePage!Prop.Row_1" не отражается...&nbsp;</p>
<p class="o">Через Characters. Примерно так:&nbsp;</p>
<p class="t">Dim vsoChar As Visio.CharactersSet vsoChar = MyShape.CharactersvsoChar.Begin = 0vsoChar.End = 0vsoChar.AddCustomFieldU "sheet.1!User.1", visFmtNumGenNoUnits&nbsp;</p>
<div id="menu-line">
<a href="mailto:gCroc@yandex.ru"> Gennady Tumanov </a>
</div></div></body></html>
