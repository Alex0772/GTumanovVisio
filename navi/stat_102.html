<html><head>
<LINK REL="STYLESHEET" HREF="vis.css">
<title>Smart-шейпы</title>
<meta name="GENERATOR" content="MSHTML 5.00.2614.3500">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<LINK REL="STYLESHEET" HREF="../vis.css">
<link rel="icon" href="../favicon.ico" />
</head>
<body bgcolor="white">
<div class="body_div">
<table class="tft" width="100%"><tr>
<td width="15%" align="center"><a href="../index.html"><img SRC="../vl1.gif" WIDTH="177" HEIGHT="80" BORDER="0" ALT=""></a>&nbsp;</td>
<td width="5%" align="center">&nbsp;</td>
<td class='menutd' width="50%" align="center">
 <a class="menu" href="http://visio.getbb.ru/">Форум visio.getbb.ru</a> |
 <a class="menu" href="../reg.htm">О форумах</a>
<br/>
 <a class="menu" href="../bib.htm">Библиотека</a> |
 <a class="menu" href="../faq.htm">Частые вопросы</a> |
 <a class="menu" href="../bookpdf.htm">Литература</a> |
 <a class="menu" href="../loading.htm">Склад материалов</a>
<br/>
 <a class="menu" href="../navi/png_1.htm">Visio Navigator</a> |
 <a class="menu" href="../blog/">Blog</a> |
 <a class="menu" href="../inforesurs.htm">Полезные ссылки</a> |
 <a class="menu" href="../site.htm">О сайте</a>
<br/>
 <a class="menu" href="../visicorp.htm">История Visio</a> |
 <a class="menu" href="../product.htm">Продукты Visio</a>
</td>
<td width="5%" align="center">&nbsp;</td>
<td width="25%" align="center">
<script async src="https://cse.google.com/cse.js?cx=f5e9a9cb1467f4600">
</script>
<div class="gcse-search"></div>
</td></tr></table>
<table width="100%" cellpadding="0" cellspacing="0" class="min"><tr><td width="10%" align="center">&nbsp;</td>
	<td width="90%">&nbsp;&nbsp;Для русскоязычных пользователей Visio. Начинающих и профессионалов.
Где взять, как сделать, что купить и т.д.
</td></tr></table>
<!-- основной контент -->

<h1>Smart-шейпы</h1>
<h2> Перечень литературы </h2>
<p>10.11.2021&nbsp;<b><noindex><a target = new href=https://www.youtube.com/watch?v=lSXBGQps9b0
 rel="nofollow">&nbspShapeSheet. Управление видимостью фигур</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspKuzin Alexander&nbsp;</a>
&nbsp;&nbsp;</noindex>Video&nbsp</p>
<p>27.03.2020&nbsp;<b><noindex><a target = new href=http://www.visguy.com/2020/03/27/extreme-scales-in-visio/
 rel="nofollow">&nbspExtreme Scales in Visio</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspChris Roth&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>08.03.2020&nbsp;<b><noindex><a target = new href=https://visualsignals.typepad.co.uk/vislog/2020/03/creating-a-visio-shape-with-an-expanding-row-count.html
 rel="nofollow">&nbspCreating a Visio shape with an expanding row count</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspJohn Goldsmith&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>15.01.2020&nbsp;<b><noindex><a target = new href=https://morganadairdocumentation.wordpress.com/2020/01/15/creating-a-visio-smart-shape-1/
 rel="nofollow">&nbspVisio: Creating a Smart Shape</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspMorgan Adair&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>16.12.2019&nbsp;<b><noindex><a target = new href=blog/25-shejp-dlya-otobrazheniya-sobytij.html
 rel="nofollow">&nbspШейп для отображения событий</a></noindex></b>&nbsp;&nbsp;<noindex>
Геннадий Туманов
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>17.11.2019&nbsp;<b><noindex><a target = new href=blog/24-smart-shejp-aktivy.html
 rel="nofollow">&nbspСмарт-шейп Активы</a></noindex></b>&nbsp;&nbsp;<noindex>
Геннадий Туманов
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>17.04.2014&nbsp;<b><noindex><a target = new href=http://guides.wmlcloud.com/office/Developing-Custom-Microsoft-Visio-2010-Solutions---Creating-SmartShapes-with-the-ShapeSheet-(part-1)---Introducing-the-ShapeSheet-.aspx
 rel="nofollow">&nbspCreating SmartShapes with the ShapeSheet (part 1) - Introducing the ShapeSheet</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspMicrosoft&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>03.02.2012&nbsp;<b><noindex><a target = new href=http://www.visguy.com/2012/02/03/easy-music-note-paper-with-the-smart-staff-shape/
 rel="nofollow">&nbspEasy Music Note Paper with the Smart Staff Shape!</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspChris Roth&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>21.01.2011&nbsp;<b><noindex><a target = new href=https://visualsignals.typepad.co.uk/vislog/2011/01/how-fonts-travel-in-visio.html
 rel="nofollow">&nbspHow fonts travel in Visio</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspJohn Goldsmith&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>24.06.2010&nbsp;<b><noindex><a target = new href=http://www.visguy.com/2010/06/24/jump-to-any-page-with-visio-smartshapes/
 rel="nofollow">&nbspJump to Any Page With Visio SmartShapes</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspChris Roth&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>31.05.2010&nbsp;<b><noindex><a target = new href=http://www.visguy.com/2010/05/31/playing-with-the-shape-of-data/
 rel="nofollow">&nbspPlaying with the Shape of Data</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspChris Roth&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>22.07.2009&nbsp;<b><noindex><a target = new href=http://www.visguy.com/2009/07/22/why-visio-shape-smarts-makes-your-life-easier/
 rel="nofollow">&nbspWhy Visio Shape Smarts Makes Your Life Easier</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspChris Roth&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>27.03.2009&nbsp;<b><noindex><a target = new href=http://www.visguy.com/2009/03/27/run-circles-around-your-text-with-the-circle-text-title-smartshape/
 rel="nofollow">&nbspRun Circles Around Your Text With the Circle-text Title SmartShape</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspChris Roth&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>25.09.2008&nbsp;<b><noindex><a target = new href=biblio/st003.htm
 rel="nofollow">&nbspСмарт-шейпы</a></noindex></b>&nbsp;&nbsp;<noindex>
Геннадий Туманов
&nbsp;&nbsp;</noindex>Из серии статей об автоматизации. Как создавать интеллектуальные шейпы. Рассматриваются практические примеры работы с шейп-листом.&nbsp</p>
<p>22.09.2008&nbsp;<b><noindex><a target = new href=http://www.visguy.com/2008/09/22/a-smartshape-is-worth-1000-symbols/
 rel="nofollow">&nbspA SmartShape is Worth 1000 Symbols</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspChris Roth&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<p>14.06.2008&nbsp;<b><noindex><a target = new href=http://www.visguy.com/2008/06/14/punish-your-users-with-not-so-smartshapes-that-misbehave/
 rel="nofollow">&nbspPunish Your Users with (not so) SmartShapes That Misbehave</a></noindex></b>&nbsp;&nbsp;<noindex>
<a target=new href="rel ="nofollow">&nbspChris Roth&nbsp;</a>
&nbsp;&nbsp;</noindex>&nbsp</p>
<h2> Ответы на вопросы</h2>
<p class="n">Фиксированный список в ShapeData и единицы измерения - ошибка конвертирования</p>
<p class="v">Замечено, что в некоторых случаях Visio нежелательно конвертирует фиксированный список в ShapeData. Это происходит,если значение похоже на числовое значение с единицами измерения. Например, значения из списка Prop.fieldValue.Format="25P;13IN" конвертируются в "25 p", "13 in".&nbsp;</p>
<p class="o">Варианты исправления ситуации:1. В случаях, когда возможна угроза нежелательного конвертирования, использовать явно текстовый формат.Например, вместо "25P;13IN" использовать """25P"";""13IN""".Тогда в окне ShapeData вместо 25 p будет видно "25P".Если все-таки при чтении данных необходимо получить именно 25P, то использовать формулу =SUBSTITUTE(Prop.Row_1,Chr(34),"") или=MID(Prop.Row_1,2,LEN(Prop.Row_1)-2)В случае SUBSTITUTE предполагается, что сами значения не должны содержать кавычек. Иначе данные будут искажены.2. Другой вариант - экранировать значения спецсимволом. Например знак "_" в конце значения или (по аналогии с Excel) знак апострофа в начале значения.То есть "25P_;13IN_" или "'25P;'13IN".Соответственно удаление экранирующего символа производить формулой&nbsp;</p>
<p class="t">=SUBSTITUTE(Prop.Row_1,"_","") или=IF(RIGHT(Prop.Row_1,1)="_",LEFT(Prop.Row_1,LEN(Prop.Row_1)-1),Prop.Row_1) или=IF(LEFT(Prop.Row_1,1)="'",RIGHT(Prop.Row_1,LEN(Prop.Row_1)-1),Prop.Row_1)&nbsp;</p>
<p class="o">источник: http://visguy.com/vgforum/index.php?topic=8634.msg37648&nbsp;</p>
<p class="n">Как вычислить факт подключения динамического коннектора</p>
<p class="v">Я пытаюсь заставить динамический коннектор показывать другой цвет, если он не подключен к шейпам обоими концами. Насколько я могу судить, единственное, что изменяется при соединении - это то, что в ячейках BeginX, EndX литеральные значения изменяются на функции. Существует ли функция, которую можно использовать, чтобы отличить функцию от литерала (или есть какой-либо другой способ)?&nbsp;</p>
<p class="o">Можно использовать EndTrigger/BeginTrigger в секции GlueInfo.&nbsp;</p>
<p class="t">LineColor=IF(BegTrigger+EndTrigger>=3,2,0)&nbsp;</p>
<p class="v">Да, вроде бы это работает. Но мой Visio показывает _XFTrigger(Connector!EventXFMod) или _XFTRIGGER(Sheet.17!EventXFMod). Получается, что это как-то превращается в 1/2?&nbsp;</p>
<p class="o">То, что вы видите - это формулы. Щелкните правой кнопкой на ячейке и выберите "show values". Или нажмите F5 для переключения формула/значение.&nbsp;</p>
<p class="n">Как задать фиксированное расстояние Connection points на коннекторе</p>
<p class="v">Я пытаюсь сделать смарт-шейп, который автоматически корректируется в зависимости от данных, поступающих из БД. Одна из последних задач - сделать на коннекторе две точки соединения, чтобы одна была на 10 мм от начала коннектора, а вторая - на 10 мм от конца.Проблема в том, что точки соединения не остаются на коннекторе или нарушается расстояние.&nbsp;</p>
<p class="o">Если у вас Visio 2010 или старше, можно использовать функцию pointalongpath. Только нужна небольшая добавка, потому что эта функция принимает процент от пути, а не абсолютное расстояние. Поэтому нужно 10 мм преобразовать в процент.&nbsp;</p>
<p class="t">User.Pathlength = Guard(PathLength(Geometry1.Path)+0 mm)User.Percentile = Guard(10 mm/User.Pathlength)Connections.Port1 X = Guard(Pointalongpath(Geometry1.Path,User.Percentile))Connections.Port1 Y = Guard(Pointalongpath(Geometry1.Path,User.Percentile))Connections.Port2 X = Guard(Pointalongpath(Geometry1.Path,1-User.Percentile))Connections.Port2 Y = Guard(Pointalongpath(Geometry1.Path,1-User.Percentile))&nbsp;</p>
<p class="o">Источник - http://visguy.com/vgforum/index.php?topic=8717&nbsp;</p>
<div id="menu-line">
<a href="mailto:gCroc@yandex.ru"> Gennady Tumanov </a>
</div></div></body></html>
