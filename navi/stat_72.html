<html><head>
<LINK REL="STYLESHEET" HREF="vis.css">
<title>Логика</title>
<meta name="GENERATOR" content="MSHTML 5.00.2614.3500">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<LINK REL="STYLESHEET" HREF="../vis.css">
<link rel="icon" href="../favicon.ico" />
</head>
<body bgcolor="white">
<div class="body_div">
<table class="tft" width="100%"><tr>
<td width="15%" align="center"><a href="../index.html"><img SRC="../vl1.gif" WIDTH="177" HEIGHT="80" BORDER="0" ALT=""></a>&nbsp;</td>
<td width="5%" align="center">&nbsp;</td>
<td class='menutd' width="50%" align="center">
 <a class="menu" href="http://visio.getbb.ru/">Форум visio.getbb.ru</a> |
 <a class="menu" href="../reg.htm">О форумах</a>
<br/>
 <a class="menu" href="../bib.htm">Библиотека</a> |
 <a class="menu" href="../faq.htm">Частые вопросы</a> |
 <a class="menu" href="../bookpdf.htm">Литература</a> |
 <a class="menu" href="../loading.htm">Склад материалов</a>
<br/>
 <a class="menu" href="../navi/png_1.htm">Visio Navigator</a> |
 <a class="menu" href="../blog/">Blog</a> |
 <a class="menu" href="../inforesurs.htm">Полезные ссылки</a> |
 <a class="menu" href="../site.htm">О сайте</a>
<br/>
 <a class="menu" href="../visicorp.htm">История Visio</a> |
 <a class="menu" href="../product.htm">Продукты Visio</a>
</td>
<td width="5%" align="center">&nbsp;</td>
<td width="25%" align="center">
<script async src="https://cse.google.com/cse.js?cx=f5e9a9cb1467f4600">
</script>
<div class="gcse-search"></div>
</td></tr></table>
<table width="100%" cellpadding="0" cellspacing="0" class="min"><tr><td width="10%" align="center">&nbsp;</td>
	<td width="90%">&nbsp;&nbsp;Для русскоязычных пользователей Visio. Начинающих и профессионалов.
Где взять, как сделать, что купить и т.д.
</td></tr></table>
<!-- основной контент -->

<h1>Логика</h1>
<p>Рассмотрим, что может использовать Visio для взаимосвязи внутри диаграмм, для соединения и связывания шейпов друг с другом.</p>
<p>Отношения могут быть выражены различными способами. Например, по положению и расстоянию между шейпами, по цвету, по соединению, по входимости или обводке, по порядку, по ассоциации. Есть еще много других, таких как размер, текстура и, конечно же, форма, но четыре из этих отношений особенно выделяются при использовании Visio. Это</p>
<ul>
<li>соединения;</li>
<li>контейнеры;</li>
<li>порядок следования;</li>
<li>ассоциации.</li>
</ul>
<p><img src="st/stat_72_f/image001.png" width="787" height="225" border="0" alt=""></p>
<p>Хотя многие приложения для рисования могут рисовать два прямоугольника и линию между двумя прямоугольниками, Visio отличается тем, что может фиксировать как логическую, так и визуальную взаимосвязь. Предоставляя эту логическую связь, Visio позволяет вам читать, какие шейпы связаны друг с другом или какие шейпы содержатся друг в друге.</p>
<p>Это позволяет вам перемещаться по всем соединениям на диаграмме, например, чтобы прочитать иерархию на организационной диаграмме или понять, какие шейпы процессов находятся в определенной функциональной дорожке.</p>
<p>Рассмотрим по порядку показанный выше 4 типа отношений.</p>
<h2>Соединения</h2>
<p>Visio поддерживает связи между шейпами с помощью системы, называемой клеем. В связанной диаграмме именно эта связующая концепция обеспечивает логические связи между объектами.</p>
<p>Клей создается либо с помощью кода, либо с помощью действий в пользовательском интерфейсе. Например, если вы перетащите конечную точку одномерной фигуры на другую, Visio выделит места, к которым можно приклеить конечную точку.</p>
<p><img src="st/stat_72_f/image002.png" width="366" height="253" border="0" alt=""></p>
<p>Если вы отпустите кнопку мыши, скажем, над одной из четырех точек соединения, конечная точка соединителя будет приклеена к целевому шейпу. При изменении положения прямоугольника конечная точка линии будет следовать за точкой, к которой она была приклеена.</p>
<p>Если вы посмотрите на ячейки ShapeSheet в 1D шейпе, вы увидите, как это происходит в Visio. Когда кнопка мыши отпущена, Visio создает некоторые формулы в ячейки конечных точек, чтобы отслеживать точку на целевом шейпе.</p>
<p><img src="st/stat_72_f/image003.png" width="509" height="73" border="0" alt=""></p>
<p>В некоторых ситуациях, например при приклеивании к геометрии шейпа или к управляющей точке, Visio динамически добавляет точки соединения к целевому шейпу. Но если не считать этого, то чаще всего целевой шейп остается нетронутым. Если посмотреть на ячейки в целевом шейпе, то будет видно, что приклеивание не вызвало никаких изменений.</p>
<p>Все это подчеркивает, что клей не является равноправным отношением, есть приклеиваемый шейп и целевой шейп.</p>
<p>Если переместить целевой шейп, соединение сохранится, но если вы переместить приклеиваемый шейп, то соединение разорвется.</p>
<p>Можно представить это с точки зрения создания клея. Если вы перетаскиваете шейп к другому шейпу для приклеивания, то перетаскиваемый шейп является клеем, а тот, к которому нужно приклеить, является целью.</p>
<p>Давайте теперь посмотрим, какие части шейпа к каким можно приклеить.</p>
<p>Самый распространенный тип приклеивания в Visio - это конечная точка одномерного шейпа, приклеиваемая к некоторой части двухмерного шейпа.</p>
<p>Вот слегка измененная версия ранее рассмотренного прямоугольника.</p>
<p><img src="st/stat_72_f/image004.png" width="214" height="152" border="0" alt=""></p>
<p>Я внес несколько изменений в геометрию, чтобы выделить некоторые типы клея, в том числе круговой вырез, положение которого основано на управляющем маркере, являющемся частью шейпа.</p>
<p>Есть пять основных элементов, к которым можно приклеить конечную точку:</p>
<ul>
<li>маркеры (Selection handle);</li>
<li>геометрия;</li>
<li>точки соединения (Connection Point);</li>
<li>вершины шейпа (Vertex) – точки между сегментами геометрии;</li>
<li>направляющие линии (Guide);</li>
<li>направляющие точки (Guide Point).</li>
</ul>
<p><img src="st/stat_72_f/image005.png" width="681" height="240" border="0" alt=""></p>
<p>Помимо конечных точек 1D шейпа в качестве приклеиваемых можно использовать управляющие точки шейпа и точки соединения. И наконец, вы можете приклеить маркеры выравнивания 2D шейпов и маркеры селектирования к направляющей.</p>
<p>Так, например, я могу перетащить управляющую точку одного 2D шейпа и приклеить ее к точке соединения в другом шейпе.</p>
<p>Точно так же, перетаскивая один 2D шейп на соседний, я смогу приклеить точку соединения перетаскиваемого шейпа к той, которая существует в целевом шейпе.</p>
<p><img src="st/stat_72_f/image006.png" width="504" height="114" border="0" alt=""></p>
<p>До сих пор мы рассматривали то, что известно как статическое склеивание, и это один из двух типов склеивания, доступных в Visio. Другой называется динамическим клеем.</p>
<p>При использовании статического клея вы приклеиваете точку исходной формы или приклеиваете к точке целевой формы. Если после такого приклеивания мы будем перемещать целевой шейп, то линия будет все время тянуться к точке приклеивания.</p>
<p>Теперь сравните это с динамическим клеем. Если возьмем конечную точку новой линии и будем перемещать над целевым шейпом, то мы увидим существующие точки соединения, к которым можно приклеить.</p>
<p><img src="st/stat_72_f/image007.png" width="322" height="158" border="0" alt=""></p>
<p>И если отпустить мышь над одной из них, получим еще одно статическое соединение. Но обратите внимание, что если мышь находится где-то еще в шейпе, весь шейп выделяется зеленой рамкой, указывая на то, что вместо этого будет создано динамическое приклеивание. И после такого приклеивания линия не будет тянуться к фиксированной точке, а будет динамически отслеживать перемещение, чтобы найти кратчайший путь от края шейпа.</p>
<p>В то время как динамическое склеивание имеет смысл для многих ситуаций, таких как организационная схема или схема процессов, в других, таких как электрическая схема, это явно не так. Это ключевой выбор при разработке вашего решения. Например, если вы посмотрите на эти простые формы процессов, вам, вероятно, все равно, к какой точке соединения подключена соединительная линия. Достаточно знать, что концептуально процесс A связан с решением B. Значит в этой ситуации динамический клей является правильным выбором.</p>
<p><img src="st/stat_72_f/image008.png" width="182" height="225" border="0" alt=""></p>
<p>Но если вы посмотрите на принципиальную схему, очевидно, важно, чтобы провода оставались подключенными к тем же точкам, к которым они были изначально приклеены. И поэтому здесь можно использовать статический клей.</p>
<p><img src="st/stat_72_f/image009.png" width="236" height="249" border="0" alt=""></p>
<p>Таким образом, концепция склеивания - это просто метод, позволяющий Visio создавать как визуальные, так и логические связи между фигурами. И поведение этих соединений определяется тем, являются ли они статическими и остаются приклеенными к определенной точке или динамическими, когда требуется найти наиболее подходящий путь.</p>
<h2>Входимость</h2>
<p>Теперь перейдем к входимости. Если линия между двумя сущностями показывает отношение посредством соединения, входимость подразумевает некоторую форму собственности или принадлежность одной сущности к какой-либо другой.</p>
<p>До версии 2010 вы могли отобразить этот тип отношений в Visio, либо нарисовав прямоугольник вокруг другого набора шейпов, либо фактически сгруппировав набор дочерних шейпов для создания одного родителя.</p>
<p><img src="st/stat_72_f/image010.png" width="450" height="206" border="0" alt=""></p>
<p>Оба метода хорошо работают во многих ситуациях, но оба имеют свои недостатки. Метод прямоугольника, хотя и гибкий, необходимо обновлять вручную каждый раз, когда один из целевых шейпов перемещается в содержащую область или из нее. В коде вы можете выполнять множество пространственных запросов, но вам все равно нужно понимать намерение пользователя, когда он добавляет, удаляет или просто перемещает один из шейпов. Кроме того, целевые шейпы не знают, принадлежат ли они ограничивающему прямоугольнику или нет.</p>
<p>С другой стороны, при группировке целевые шейпы имеют более постоянную связь со своим родителем. Группировка, как правило, лучше подходит для более статичных компонентов, которые являются частью отдельного единого блока, например, ножки стула или дверь автомобиля.</p>
<p>Контейнеры, которые были представлены в Visio 2010, устраняют эти недостатки и находятся в середине спектра гибкости, поддерживая отношения, но, что особенно важно, не изменяя базовую структуру. Так что подумайте, например, о сотрудниках, назначенных в проектные группы или какое-либо другое организационное подразделение.</p>
<p><img src="st/stat_72_f/image011.png" width="367" height="367" border="0" alt=""></p>
<p>Здесь показаны два шейпа контейнера, и я могу выбрать набор сотрудников и добавить их в контейнер региональных менеджеров.</p>
<p>Обратите внимание, что когда я перетаскиваю шейпы  на контейнер, Visio отображает зеленый прямоугольник вокруг края контейнера, указывающий, что шейпы станут членами контейнера. После того как они добавлены, я могу перемещать контейнер, и шейпы элементов следуют за ним.</p>
<p>Но важно понимать, что структура шейпов не изменилась, и я все еще могу выбрать одного сотрудника, переместить ее из контейнера, а оставшиеся шейпы участников останутся нетронутыми.</p>
<p>Еще одна ключевая особенность контейнеров заключается в том, что шейпы-члены могут получить ссылку на контейнер, в котором они находятся. Поэтому в этих шейпах сотрудников я добавил небольшой кружок, который динамически меняется, чтобы выделить, в каком контейнере они находятся.</p>
<p><img src="st/stat_72_f/image012.png" width="375" height="205" border="0" alt=""></p>
<p>Если я переведу этих четырех сотрудников в команду по открытию новых магазинов, вы увидите, что кружки отражают это изменение. Я также добавил числовое текстовое поле в область заголовка контейнера, чтобы отображать изменяющееся количество элементов, чтобы показать, как форма контейнера может знать свои элементы.</p>
<p>Это демонстрация того, что нам удалось изменить данные в шейпе экземпляра, просто позволив пользователю перемещать шейп на странице. И это довольно мощно.</p>
<h2>Структурированное построение диаграмм</h2>
<p>Как я уже упоминал, контейнеры были представлены в Visio 2010 и являются частью функции, называемой структурированным построением диаграмм.</p>
<p>Эта функция состоит из трех основных типов, одной из частей которых являются контейнеры. Два других типа  это списки (Lists) и выноски (Callouts). О выносках чуть позже, а сначала давайте взглянем на списки.</p>
<h2>Списки</h2>
<p>Списки  это, по сути, еще один тип контейнера, но в котором положение и порядок следования управляются. Они позволяют отображать список шейпов как в горизонтальной, так и в вертикальной ориентации.</p>
<p>Например, вот форма списка, которую я собираюсь использовать, чтобы показать порядок ответственности за закрытие конкретной кофейни на ночь.</p>
<p><img src="st/stat_72_f/image013.png" width="120" height="217" border="0" alt=""></p>
<p>Если я перетащу менеджеров в список, вы увидите, что Visio снова отображает зеленую линию вокруг списка, чтобы показать, что шейпы станут членами списка после перетаскивания.</p>
<p>Вы также можете видеть, что если я хочу изменить порядок списка, Visio предоставляет мне связанные элементы пользовательского интерфейса, чтобы я мог это сделать. Работа контейнеров и списков основана на наборе служб построения диаграмм, работающих в Visio, которые ищут шейпы с определенным набором именованных пользовательских ячеек.</p>
<p>Если вы посмотрите на ShapeSheet шейпа списка, вы увидите, что есть несколько ячеек с именем user.msv плюс какое-то продолжение.</p>
<p><img src="st/stat_72_f/image014.png" width="602" height="177" border="0" alt=""></p>
<p>Давайте посмотрим на самые важные из них. StructureType идентифицирует шейп как тип структурированного списка. Если бы это был контейнер или выноска, значением были бы их имена.</p>
<p>Следующая ячейка, на которую следует обратить внимание, это ShapeCategories, которые можно применить к любому шейпу и которые позволяют эффективно помечать шейпы как принадлежащие к определенной категории.</p>
<p>Это, в свою очередь, можно использовать с инклюзивным или эксклюзивным фильтром, например, SDListRequiredCategories содержит список категорий, разрешенных для добавления в этот список. В этом примере видно, что список будет разрешать добавление только шейпов с типом Manager.</p>
<p>Все остальные ячейки просто определяют другие аспекты списка, такие как стиль или макет, и синхронизируются с контекстной вкладкой ленты, чтобы пользователь мог устанавливать различные параметры.</p>
<p>Таким образом, User-defined ячейки идентифицируют шейп как представляющую интерес для сервисов построения диаграмм и хранят атрибуты шейпа, но есть еще одна ячейка, которая используется для завершения функции.</p>
<p>Ниже по ShapeSheet в разделе Layout вы найдете ячейку Relationships.</p>
<p><img src="st/stat_72_f/image015.png" width="817" height="79" border="0" alt=""></p>
<p>Visio использует эту ячейку для хранения взаимосвязей между шейпами. Для шейпа списка или контейнера подобного приведенному здесь будет храниться ссылка для каждого из шейпов-членов. И если вы откроете ShapeSheet для одного из шейпов-членов, вы увидите соответствующую ссылку на ее контейнер. Хотя реально вам скорее всего никогда не придется взаимодействовать с этой ячейкой.</p>
<p>Это подчеркивает двунаправленную связь между шейпами и то, как Visio поддерживает эти отношения в фоновом режиме.</p>
<p> </p>
<h2>Выноски</h2>
<p>Выноски обеспечивают ассоциативную связь, позволяющую связать положение одной фигуры с другой. Как и контейнеры - без группировки или каких-либо изменений в структуре целевого шейпа или самой выноски.</p>
<p>Вернемся еще раз к списку закрытия магазина. Я могу добавить на страницу шейп выноски и связать его с одним из шейпов менеджера, используя управляющую точку. И отметить, что этот человек доступен только в будние дни.</p>
<p> </p>
<p><img src="st/stat_72_f/image016.png" width="202" height="217" border="0" alt=""></p>
<p>Затем я могу переместить шейп целевого менеджера, и вы увидите, как выноска следует вместе с ним.</p>
<p>Это довольно стандартный сценарий для выносок, использующий их для комментирования или выделения другого шейпа в диаграмме.</p>
<p>Но мы не ограничены только отображением текста или использованием только встроенных типов.</p>
<p><img src="st/stat_72_f/image017.png" width="174" height="59" border="0" alt=""></p>
<p>Вот еще один пользовательский шейп к которому добавлено поведение выноски. Я могу связать этот шейп ключа с щейпом менеджера, чтобы показать, кто в настоящее время владеет ключами от магазина. Опять же, можно изменить порядок шейпов в списке, но выноска остается связанной с тем же целевым менеджером.</p>
<p>Я могу легко передать ключ другому менеджеру, и теперь ключ будет отслеживать новую цель.</p>
<p>Вот и все, что касается отношений в Visio. Основные выводы здесь заключаются в том, что Visio поддерживает ряд различных методов, которые позволяют вам фиксировать логические отношения, которые ваши пользователи строят при сборке диаграммы. Они сделали это не путем сопоставления одного текстового поля с другим, а путем визуального перемещения объектов, которые имеют для них смысл, и области, в которой они работают.</p>
<h2>Компоновка и маршрутизация</h2>
<p>Еще одной важной особенностью является способность Visio размещать фигуры на странице, используя не только базовое выравнивание, но и принимая во внимание любые существующие взаимосвязи.</p>
<p>Например, я добавил на страницу группу простых шейпов, как показано ниже. Они пронумерованы, чтобы упростить просмотр иерархии после добавлении соединений. Добавляем соединения и для ясности установим зеленый цвет корневого узла.</p>
<p><img src="st/stat_72_f/image018.png" width="180" height="135" border="0" alt=""></p>
<p>Из-за того, что связи имеют направленный характер, Visio может интерпретировать иерархию. И вы можете видеть, как выбор встроенных стилей размещения влияет на расположение шейпов.</p>
<p></p>
<p><img src="st/stat_72_f/image019.png" width="687" height="337" border="0" alt=""></p>
<p><img src="st/stat_72_f/image020.png" width="603" height="367" border="0" alt=""></p>
<p>При использовании макета Visio различает два типа шейпов: размещаемые (Placeable) и соединяющие (Routable). Размещаемые шейпы - это шейпы, которые нужно разместить или расположить на странице. Соединяющие - это шейпы-коннекторы. Размещаемые шейпы, как правило, являются 2D - шейпами, а соединяющие - 1D. Хотя не все 2D-шейпы обязательно размещаемые, и точно так же не все 1D-шейпы могут быть соединяющими.</p>
<p>Конечно, как и в большинстве случаев в Visio, в ShapeSheet есть соответствующая ячейка. И в данном случае это ячейка с именем ObjType. Именно она определяет, какой это тип.</p>
<p>При разработке шейпа вы можете решить, нужно ли вам, чтобы шейп был размещаемым, например узел блок-схемы, или вы хотите отказаться от влияния макета, например, для шейпа, которая представляет столб или стену в здании.</p>
<p>Как правило, новые шейпы, рисуемые на странице, устанавливаются таким образом, чтобы позволить Visio решать, какой тип они должны иметь. В этом случае шейп станет доступным для размещения только в том случае, если вы подключите к ней коннектор.</p>
<p>Конечно, все встроенные стили компоновки и маршрутизации можно применять через пользовательский интерфейс, но в конечном итоге все настройки, определяющие поведение, хранятся в таблице свойств фигуры как на уровне страницы, так и на уровне шейпа. Эти разделы таблицы свойств фигуры раскрывают несколько интересных деталей.</p>
<p><img src="st/stat_72_f/image021.png" width="543" height="272" border="0" alt=""></p>
<p>Во-первых, есть ячейки Plow Эти ячейки представляют концепцию, согласно которой Visio позволяет шейпам отталкивать другие шейпы, если они расположены поверх них.</p>
<p>Комбинация ShapePlowCode и ShapeFixedCode определяет, может ли шейп расталкивать другие или быть отодвинутым, и позволяет вам, как разработчику шейпа, управлять, соглашаетесь ли вы на такое поведение или отказываетесь от него.</p>
<p>В качестве примера использования этого типа функциональности  может быть план этажа кофейни. Там, когда вы перетаскиваете фигуру стола на страницу, имеет смысл, чтобы один стол не перекрыл другой, и Plow гарантирует, что этого не произойдет.</p>
<p>Второй набор ячеек, на который следует обратить внимание, - это BlockSize и AvenueSize.</p>
<p><img src="st/stat_72_f/image022.png" width="259" height="254" border="0" alt=""></p>
<p>Visio использует эти ячейки при расчете интервалов для стилей макета. Понятно, что AvenueSize используется для пространства между шейпами, а BlockSize - для пространства, заданного для каждого шейпа. Конечно, фактические размеры шейпа могут отличаться от значений BlockSize, поэтому к конечному результату применяется дополнительная логика.</p>
<p>Итак, краткий обзор компоновки и маршрутизации. Следует подчеркнуть две вещи:</p>
<p>1) Visio имеет ряд встроенных алгоритмов компоновки и доступ к ним доступен для ваших пользователей через пользовательский интерфейс или для вас с помощью методов в API.</p>
<p>2) существует разумный уровень управления мельчайшими деталями, позволяющий получить стиль, который подходит для вашего решения.</p>
<p>Конечно, ничто не мешает вам создать собственную логику, если встроенная не соответствует вашим потребностям. Но, безусловно, стоит в первую очередь взглянуть на то, что находится в коробке.</p>
<h2> Перечень литературы </h2>
<h2> Ответы на вопросы</h2>
<div id="menu-line">
<a href="mailto:gCroc@yandex.ru"> Gennady Tumanov </a>
</div></div></body></html>
