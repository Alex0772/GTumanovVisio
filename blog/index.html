<!DOCTYPE html>
<html lang="ru-ru"
      dir="ltr">
	<head>
		<meta http-equiv="Content-Type"
		      content="text/html; charset=UTF-8">
		<meta name="viewport"
			  content="width=device-width, initial-scale=1.0">
		<base href=".">
		
		<meta name="author" content="">
		<meta name="description" content="%description%">
		<title>Блог</title>
		
		<link href="/blog/template.css"
			  rel="stylesheet">
		<style>
		h1, h2, h3, h4, h5, h6, .site-title {
			font-family: 'Open Sans', sans-serif;
		}
		</style>
	</head>
	<body class="site com_content view-article no-layout no-task itemid-101">
		<!-- Body -->
		<div class="body"
			 id="top">
			<div class="container">
				<!-- Header -->
				<header class="header"
						role="banner">
					<div class="header-inner clearfix">
						<a class="brand pull-left"
						   href="https://visioport.epizy.com/blog/">
							<span class="_site-title"
								  title="VisioPort blog">VisioPort blog</span>
						</a>
						<div class="header-search pull-right"></div>
					</div>
				</header>
				<div class="row-fluid">
					<main id="content" role="main" class="span9">
						<!-- Begin Content -->
						<div class="item-page" itemscope="" itemtype="https://schema.org/Article">
							<meta itemprop="inLanguage" content="ru-RU">
<div class="page-header">
	<h1> Блог </h1>
</div>
<div itemprop="articleBody">
<p>&nbsp;</p>
<div class="page-header"> <h2> <a href ="35-treeview-cloud.html">Документирование облачных хранилищ в Visio TreeView</a></h2></div>


<div class="pull-none item-image">
	<img src="/blog/35_f/img_001.png" alt="" itemprop="image">
</div>
<div itemprop="articleBody">
	<p>Шаблон Visio TreeView изначально был разработан для документирования файловой системы. Однако пользователи постоянно задают вопрос - нельзя ли использовать его для облачных хранилищ.</p>
	<p>Отвечаю - можно, хотя и потребуются некоторые дополнительные усилия.</p>
	<p>Во-первых, помимо сканирования файловой системы шаблон обеспечивает прием данных из текстового файла. То есть достаточно каким-то образом отсканировать любое хранилище и представить данные в определенном формате, чтобы потом отобразить их в Visio TreeView. По этому варианту было сделано два дополнительных приложения:</p>
<div class="jcomments-links"><a class="readmore-link" href="35-treeview-cloud.html" title="Документирование облачных хранилищ в Visio TreeView"> Подробнее: Документирование облачных хранилищ в Visio TreeView</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 28 February 2022</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="34-thedocref.html">Опасные ссылки на TheDoc в Visio</a></h2></div>

		
<div class="pull-none item-image"> <img src="34_f/img008.png" alt="" itemprop="image"> </div>
			<div itemprop="articleBody">
		<p>В формулах шейп-листа часто используются ссылки на другие ячейки. Ячейки того же шейпа, другого шейпа, страницы, документа. Однако, как показывает практика, такие ссылки работают не всегда. Например, в старших версиях Visio может не работать ссылка на документ.</p>
<div class="jcomments-links"><a class="readmore-link" href="34-thedocref.html" title="Опасные ссылки на TheDoc в Visio"> Подробнее: Опасные ссылки на TheDoc в Visio</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 20 December 2021</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="33-matchondrop.html">Разбираемся с галочкой Match master by name on drop</a></h2></div>

		
<div class="pull-none item-image"> <img src="33_f/c01.PNG" alt="" itemprop="image"> </div>
			<div itemprop="articleBody">
		<p>Недавно в форуме задали вопрос - что делает эта галочка. Справка высказывается по этому поводу довольно невнятно, поэтому я решил нарисовать для пояснения несколько примеров. Все-таки картинки бывают понятнее, чем слова.</p>
<p>Начнем с того, что главным словом здесь будет "наследование". В данном случае наследование шейпом свойств мастер-шейпа при перетаскивании его на страницу рисунка. Причем рассматривается конфликт при наследовании. Ведь мы обычно ожидаем, что при перетаскивании мастер-шейпа на страницу мы получим его копию. То есть копия должны унаследовать все свойства мастер-шейпа. В простейшем случае это так и есть. Но при наличии нескольких похожих мастер-шейпов реакция может оказаться неожиданной.</p>
<div class="jcomments-links"><a class="readmore-link" href="33-matchondrop.html" title="Разбираемся с галочкой Match master by name on drop"> Подробнее: Разбираемся с галочкой Match master by name on drop</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 17 September 2020</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="32-visio-package-helper.html">Опыты с утилитой для просмотра пакетного формата Visio</a></h2></div>


<div class="pull-none item-image"> <img src="32_f/pck001.png" alt="" itemprop="image"> </div>
			<div itemprop="articleBody">
		<p>Пакетный формат файла появился в Visio, начиная с версии 2013, и остается основным действующим во всех последующих версиях. Документ Visio представляет собой архив, содержащий множество папок и XML файлов. В принципе, это обычный ZIP архив. То есть всегда можно разархивировать его и посмотреть любой отдельный файл. Причем, не только вручную, но и программно.</p>
<p>Это привело к тому, что документ Visio стал "прозрачным", то есть его можно рассматривать не только через шейп-лит или программно через объектную модель, но и в текстовом редакторе. Хочу остановиться на вопросе - как это может помочь при документировании разработки?</p>
<p>Вообще, документирование разработки - это очень непростой вопрос. Вот например, все привыкли, что разработка прибора всегда сопровождается разработкой схемы и технического описания. К программе тоже обязан прилагаться как минимум текст программы и чаще всего описание. А теперь вспомните - встречали ли вы когда-нибудь документацию на решение на основе Visio? Скорее всего - нет.</p>
<div class="jcomments-links"><a class="readmore-link" href="32-visio-package-helper.html" title="Опыты с утилитой для просмотра пакетного формата Visio"> Подробнее: Опыты с утилитой для просмотра пакетного формата Visio</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 07 August 2020</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="31-ribb-vba.html">Вызов макросов из риббона в Visio</a></h2></div>


<div class="pull-none item-image"> <img src="31_f/rvba1.png" alt="" itemprop="image"> </div>
			<div itemprop="articleBody">
		<p>Эта статья не содержит открытий, а больше похожа на запись "для памяти". Чтобы, когда понадобится, можно было быстренько вспомнить и подключить к документу Visio риббон с пользовательской вкладкой.</p>
<p><strong>Постановка задачи</strong>. Имеется документ с макросами; задача - добавить вызов макросов из риббона.</p>
<p>В районе 2007-2010 с появлением риббона было несколько публикаций на тему, как добавить к нему свою вкладку. Практически все они основывались на интерфейсе IRibbonExtensibility и подключении пользовательского риббона в момент открытия документа.</p>
<p>Однако с появлением в Visio 2013 нового (пакетного) формата файлов появилась возможность намертво связать пользовательский риббон с документом, просто навсегда включить его в состав документа. Получается простая и компактная конструкция, которой вполне достаточно, чтобы управлять несколькими макросами.</p>
<div class="jcomments-links"><a class="readmore-link" href="31-ribb-vba.html" title="Вызов макросов из риббона в Visio"> Подробнее: Вызов макросов из риббона в Visio</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 29 July 2020</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="30-shape-data.html">Shape Data Window и отложенные события</a></h2></div>


<div itemprop="articleBody">
		<p>Недавно в форуме возник вопрос - почему не отображается изменение данных в окне Shape Data Window. Рассматривалась вот такая конструкция.</p>
<p><img src="/blog/30_f/sdt001.png" alt=""></p>
<p>Страница имеет 4 поля данных. По замыслу переключение значения в поле Show/Hide All должно переключать видимость остальных трех полей.Цепочка событий:</p>
<ul>
<li>изменяем Show на Hide в окне Shape Data;</li>
<li>значение ячейки User.HideAll изменяется с FALSE на TRUE;</li>
<li>значение ячеек Invisible трех остальных полей переключается в TRUE;</li>
<li>поля A, B, C в окне Shape Data становятся скрытыми.</li>
</ul>
<p>Так вот, пользователь заметил, что такая конструкция на уровне шейпа работает, как и задумано, а вот на уровне страницы поведение сильно отличается.</p>
<div class="jcomments-links"><a class="readmore-link" href="30-shape-data.html" title="Shape Data Window и отложенные события"> Подробнее: Shape Data Window и отложенные события</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 20 July 2020</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="19-sozdanie-slozhnykh-formul-v-visio-s-pomoshchyu-excel.html">Создание сложных формул в Visio с помощью Excel</a></h2></div>

		
<div itemprop="articleBody">
		<p>&nbsp;</p>
<p>Недавно потребовалось сделать смарт-шейп... Такой весь из-себя управляемый данными. И формулы получались довольно сложными. Вот например, есть список типов</p>
<pre class="language-markup"><code>принтер;МФУ;копир;сканер;терминал;инж.сист.;факс;дупликатор</code></pre>
<p>и задание к нему - в зависимости от типа отображать одну из 5 картинок. В итоге требование вылилось вот в такую формулу с вложенными IF, OR и STRSAME.</p>
<pre class="language-markup"><code>IF(STRSAME(Prop._VisDM_Тип_устр,"Принтер",1),4,IF(STRSAME(Prop._VisDM_Тип_устр,"Инж.сист.",1),3,IF(OR(STRSAME(Prop._VisDM_Тип_устр,"Сканер",1),STRSAME(Prop._VisDM_Тип_устр,"Факс",1)),2,IF(OR(STRSAME(Prop._VisDM_Тип_устр,"МФУ",1),STRSAME(Prop._VisDM_Тип_устр,"Копир",1),STRSAME(Prop._VisDM_Тип_устр,"Дупликатор",1)),1,0))))</code></pre>
<p>Написал, проверил - получил ошибку. Исправил - опять ошибка. Ну невозможно сходу и без ошибок создать такое.</p>
<div class="jcomments-links"><a class="readmore-link" href="19-sozdanie-slozhnykh-formul-v-visio-s-pomoshchyu-excel.html" title="Создание сложных формул в Visio с помощью Excel"> Подробнее: Создание сложных формул в Visio с помощью Excel</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 01 November 2019</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="18-registratsiya-sobytij-visio.html">Регистрация событий Visio</a></h2></div>

		
<div class="pull-left item-image"> <img src="18_f/fnm_02.png" alt="" itemprop="image"> </div>
			<div itemprop="articleBody">
		<p>&nbsp;</p>
<p>В предыдущей статье <a href="17-funktsiya-filename-i-vse-takoe.html">Функция FILENAME() и все такое</a> я рассказывал о конструкции из формул шейп-листа, в которой формулы выстраивались в своего рода логическую цепочку и должны были срабатывать одна за другой. Кстати, цепочка была замкнутой, что еще интереснее. Но так как наши представления о последовательности выполнения формул не всегда соответствуют действительности, возникло желание каким-то образом посмотреть реальную последовательность.</p>
<p>Итак, имеем исходный документ (VSDX), в котором прописаны несколько связанных формул в шейп-листе документа и ссылающаяся на него формула в единственном шейпе на странице. Повторю картинку-схему.</p>
<div class="jcomments-links"><a class="readmore-link" href="18-registratsiya-sobytij-visio.html" title="Регистрация событий Visio"> Подробнее: Регистрация событий Visio</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 17 October 2019</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="17-funktsiya-filename-i-vse-takoe.html">Функция FILENAME() и все такое</a></h2></div>


<div class="pull-left item-image"> <img src="17_f/fnm_01.png" alt="" itemprop="image"> </div>
			<div itemprop="articleBody">
		<p>&nbsp;</p>
<p>Все началось с вопроса к этой функции. Пользователь заметил, что после ручного переименования файла VSDX функция начинает врать. Открываешь уже новый файл, а в поле, которое ссылается на эту функцию, выдается прежнее значение. Причем в версиях Visio 2007 и ниже баг отсутствовал и проявляется только во всех версиях с новым форматом.</p>
<p>Да, значение можно обновить. Например, если открыть шейп-лист, найти ячейку, использующую функцию, в строке редактирования встать в конце формулы и нажать Enter. Или через SaveAs сохранить файл под новым именем. И в том, и в другом случае поле обновляется, но дя этого нужны ручные действия. А главное - нужно вовремя вспомнить о них, иначе в документе останется ошибка, а это неприятно.</p>
<p>В процессе исследований выяснилось, что попытка перезаписи формулы с FileName() с использованием функции SETF() не помогает. Когда в ячейку пишется та же самая формула, то в ячейке вроде как ничего и не меняется. Значит и обновляться она не собирается.</p>
<div class="jcomments-links"><a class="readmore-link" href="17-funktsiya-filename-i-vse-takoe.html" title="Функция FILENAME() и все такое"> Подробнее: Функция FILENAME() и все такое</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 17 October 2019</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="16-help-kartinka.html">Help-картинка</a></h2></div>

		
<div class="pull-left item-image"> <img src="16_f/hpic2.png" alt="" itemprop="image"> </div>
			<div itemprop="articleBody">
		<p><br>В предыдущей статье говорилось о том, как создать CHM справку для шейпов разработанного трафарета. Сейчас хочу показать несколько другой подход.</p>
<p>CHM справка все-таки требует наличия дополнительного файла. Его надо правильно разместить и настроить взаимодействие с шейпами. Но что если встроить справку непосредственно в сам шейп! То есть внедрить OLE объект, сжать его в точку для невидимости в обычном режиме и открывать при необходимости.</p>
<p>Windows позволяет встроить множество типов разных объектов: Wordpad, документ Word, даже документ Visio. Но есть еще более интересный вариант - встроить универсальный контейнер для объектов. Такой контейнер существует - это объект Package.</p>
<div class="jcomments-links"><a class="readmore-link" href="16-help-kartinka.html" title="Help-картинка"> Подробнее: Help-картинка</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 10 October 2019</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="15-polzovatelskaya-spravka-dlya-shejpov.html">Пользовательская справка для шейпов</a></h2></div>

		
<div class="pull-left item-image"> <img src="15_f/hlp.png" alt="" itemprop="image"> </div>
			<div itemprop="articleBody">
		<p>&nbsp;</p>
<p>Расширение Visio воспринимается лучше, когда оно сопровождается справкой. В простейшем случае это может быть текстовый файл, иногда PDF. Если объем справочных сведений достаточно большой, то желательно оформить справку в формате CHM. Это уже несколько труднее, чем просто написать файл Word. Вот о справке в CHM и пойдет речь ниже.</p>
<p>Собственно, сделать CHM файл не составляет особого труда. Существуют бесплатные инструменты, помогающие либо конвертировать сайт в формат CHM, либо прямо в этом инструменте вручную набрать оглавление и текст страничек справки. Для вызова такой справки можно либо предусмотреть кнопку на риббоне, либо вызывать ее макросом. При этом вызванная справка по умолчанию позиционируется на главную страницу, а далее действуют кнопки управления движком справки.</p>
<p>Но иногда хочется напрямую вызвать страницу, связанную с определенным щейпом. Такой вариант тоже возможен. Документация Visio советует использовать меню Developer / Shape Name и вписывать ссылку в поле Help: в формате FILENAME!#Number, где FILENAME - имя файла справки, а Number - числовой ID нужной страницы, назначенный в MAP секции проекта справки. Предполагается, что достаточно вписать туда нечто типа ShapeHelp.chm!#20000 и при нажатии на F1 откроется заданная страница справки. Кстати, попробовал и так и не добился успеха. По F1 упорно открывается стандартная справка Visio. Поэтому пришлось поискать другие методы.</p>
<div class="jcomments-links"><a class="readmore-link" href="15-polzovatelskaya-spravka-dlya-shejpov.html" title="Пользовательская справка для шейпов"> Подробнее: Пользовательская справка для шейпов</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 09 October 2019</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="14-sluchaj-s-zashchitoj-ot-vozdejstviya-tem-v-visio.html">Случай с защитой от воздействия тем в Visio</a></h2></div>

<div itemprop="articleBody">
		<p>Не секрет, что механизм тем, появившийся в последних версиях Visio, иногда плохо воспринимает трафареты, рассчитанные на отсутствие тем.</p>
<p>David J Parker в статье "<a href="https://blog.bvisual.net/2016/06/10/protecting-shapes-from-themes-in-visio-2013/">Protecting Shapes from Themes in Visio 2013+</a>" показал основные принципы защиты от воздействия тем. Но недавно я наткнулся на случай, в котором предложенный метод защиты оказался недостаточным.</p>
<p>Пользователь переделывает старые трафареты под новую версию Visio и никак не может заставить их не воспринимать темы. После более глубокого изучения трафарета оказалось, что причина кроется в использовании стилей.</p>
<p>Со стилями Microsoft поступила оригинально. Когда-то это был основной механизм предварительной настройки форматов и им часто пользовались. При переходе к темам доступ к стилям практически исключили из GUI, но сами-то стили остались. И там внутри они не только работают, но и могут существенно влиять на поведение шейпов.</p>
<p>В рассматриваемом случае в мастер-шейпе был использован стиль DFD Normal, основанный на стиле Normal. Вроде, никакого криминала. Но при переходе в новую систему наследование начинается со стиля Theme. В результате, стоит только перебросить мастер из трафарета на страницу рисунка, как в документе появляется новый стиль со следующей цепочкой наследования DFD Normal =&gt; Normal =&gt; Theme.</p>
<div class="jcomments-links"><a class="readmore-link" href="14-sluchaj-s-zashchitoj-ot-vozdejstviya-tem-v-visio.html" title="Случай с защитой от воздействия тем в Visio"> Подробнее: Случай с защитой от воздействия тем в Visio</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 11 July 2019</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="13-pro-kontekstnye-menyu.html">Про контекстные меню</a></h2></div>

		
<div itemprop="articleBody">
		<p>Недавно в форуме возник вопрос - как пристроить пункт контекстного меню шейпа не сверху, а внизу. Что удивительно, вопрос провисел долго, выдержал несколько неточных ответов и был закрыт только после появления истинного корифея. Похоже, что тема освещена явно недостаточно. Попробую слегка раскрыть.</p>
<p>Итак, контекстное меню. Довольно простой и быстрый способ придать интерактивность своему произведению. Не требует знания программирования, только шейп-лист. Может быть навешено как на шейп, так и на страницу. Очень удобно, когда не хочется заморачиваться с риббоном.</p>
<h2>Как добавить к шейпу свое меню</h2>
<p>Краткий рецепт: открыть шейп-лист, добавить секцию Actions, добавить несколько строк по количеству требуемых пунктов меню, заполнить как минимум ячейки Action и Menu.</p>
<p>У шейпа или страницы уже существует контекстное меню. Пользовательские пункты пристраиваются к нему дополнительно. По умолчанию они пристраиваются сверху. Такое поведение получается автоматически после заполнения двух указанных ячеек.</p>
<p>Плюс существует еще почти десяток ячеек, распоряжающихся нюансами поведения меню. Вот на нюансах хотелось бы остановиться подробнее. Каким может быть меню и как этого достичь.</p>
<div class="jcomments-links"><a class="readmore-link" href="13-pro-kontekstnye-menyu.html" title="Про контекстные меню"> Подробнее: Про контекстные меню</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 27 June 2019</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="12-skorost-avtokonnekta-shejpov.html">Скорость автоконнекта шейпов</a></h2></div>


<div itemprop="articleBody">
		<p>Есть у шейпа такой метод - <strong>AutoConnect</strong>. С его помощью один шейп присоединяет к себе другой.</p>
<p>Метод принимает также параметр, с помощью которого можно задать направление размещения для присоединяемого шейпа. Раньше как-то не приходилось задумываться, насколько сильно влияние этого параметра на скорость работы. Но вот неожиданно такой случай подвернулся.</p>
<p>Была у меня программка, которая выводит в графическом виде структуру модулей проектов VBA (входимость и структуру вызовов). И вот, когда понадобилось проанализировать структуру довольно сложного проекта, был поражен ее медлительностью. Естественно, начал искать причину.<br>В результате обнаружилось, что наибольшее замедление дает вот этот оператор</p>
<p><strong>Sh1.AutoConnect Sh2, visAutoConnectDirRight, mas</strong></p>
<p>Когда-то я подумал, что схема должна располагаться слева направо, поэтому особо не задумываясь, выбрал параметр visAutoConnectDirRight. Причем размещение все равно получается не оптимальным, поэтому в конце оно еще раз приглаживается с помощью ActivePage.Layout.</p>
<div class="jcomments-links"><a class="readmore-link" href="12-skorost-avtokonnekta-shejpov.html" title="Скорость автоконнекта шейпов"> Подробнее: Скорость автоконнекта шейпов</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 09 June 2019</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="11-lokalizatsiya-i-razdeliteli-v-visio.html">Локализация и разделители в Visio</a></h2></div>

		
<div itemprop="articleBody">
		<p>Ошибки, связанные с локализацией вообще не редкость. Думаю, каждый натыкался на случай, когда копируешь код из справки, а он не работает. А все потому, что в справке стоит точка, а по условиям локализации нужна запятая. Или запятая вместо точки с запятой.</p>
<p>Но еще неприятнее, когда нужен макрос, который должен работать в любой локализации. Здесь уже не обойдешься простой заменой символа в коде. Или как минимум такую замену нужно делать "на лету", во время исполнения макроса. Рассмотрим несколько примеров.</p>
<h2>Десятичный разделитель</h2>
<p>Предположим, имеется небрежно составленный файл Excel, в котором нас интересуют дробные числа. Небрежность состоит в том, что не соблюдается однообразие форматов. Например, имеются и ячейки, отформатированы как текстовые, и ячейки, отформатированные как числа. Ниже показано, как пользователь будет видеть такой файл на машинах с разной локализацией.</p>
<p><img src="11_f/ex000.jpg" alt="">&nbsp;&nbsp;<img src="11_f/ex001.jpg" alt=""></p>
<div class="jcomments-links"><a class="readmore-link" href="11-lokalizatsiya-i-razdeliteli-v-visio.html" title="Локализация и разделители в Visio"> Подробнее: Локализация и разделители в Visio</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 07 June 2019</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="10-metody-indikatsii-rezultatov.html">Методы индикации результатов</a></h2></div>

		
<div itemprop="articleBody">
		<p>Иногда возникает необходимость выбрать некоторое подмножество шейпов на странице Visio. Сам поиск проблемой не является, но нужно ведь еще отобразить его результат, причем так, чтобы и пользователю было удобно, и рисунок не испортить. Особенно в том случае, когда найденных шейпов много и они разбросаны по всей странице.</p>
<p>Понятно, что методов индикации может быть множество. И чтобы при решении каждой задачи не вспоминать их все, можно собрать все или как минимум наиболее употребительные в один модуль, чтобы оставалось только выбрать нужный. Пока в такой модуль вошли четыре метода:</p>
<ul>
<li>текстовое сообщение;</li>
<li>селектирование;</li>
<li>добавление маркера;</li>
<li>подкраска.</li>
</ul>
<div class="jcomments-links"><a class="readmore-link" href="10-metody-indikatsii-rezultatov.html" title="Методы индикации результатов"> Подробнее: Методы индикации результатов</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 27 May 2019</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="9-osobennosti-metoda-drop-shape.html">Особенности метода Drop Shape</a></h2></div>
	
	
<div itemprop="articleBody">
		<h1>Постановка задачи</h1>
<p>Речь идет о методах Drop и DropMany в Visio.</p>
<p><strong>expression.Drop(ObjectToDrop, xPos, yPos)</strong></p>
<p>Мы знаем, что в качестве ObjectToDrop может выступать как мастер, так и шейп, размещенный на странице. А в справке можно прочесть такую фразу: "If ObjectToDrop is a Master, the pin of the master is dropped at the specified coordinates". По логике - если объект является не мастером, а шейпом, то его может забросить совсем в другое место. Вот этой особенности и посвящена данная статья.</p>
<div class="jcomments-links"><a class="readmore-link" href="9-osobennosti-metoda-drop-shape.html" title="Особенности метода Drop Shape"> Подробнее: Особенности метода Drop Shape</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 26 March 2019</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="8-iz-visio-v-excel-cherez-power-query.html">Из Visio в Excel через Power Query</a></h2></div>


<div itemprop="articleBody">
		<h1>Общие сведения</h1>
<p><em>(По мотивам сообщения пользователя Machestro в <a href="http://visio.getbb.ru/viewtopic.php?f=29&amp;t=1429)">http://visio.getbb.ru/viewtopic.php?f=29&amp;t=1429)</a>.</em></p>
<p>Обычно Excel по отношению к Visio рассматривается в качестве источника данных. Тем не менее, обратный канал тоже существует. Он используется либо для формирования отчетов по документам Visio, либо при двусторонней синхронизации данных с источником. Для формирования отчетов как правило используется либо штатный формирователь отчетов, либо специализированные программные решения, создаваемые под конкретную задачу. Причем возможности формирователя отчетов достаточно ограничены.</p>
<p>Однако с появлением в Power Query функции доступа к архивированным файлам (см. http://sql10.blogspot.com/2016/06/reading-zip-files-in-powerquery-m.html) Visio получает еще один и очень неплохой способ формирования отчетов. Ведь если документ Visio представляет собой пакет из нескольких заархивированных XML файлов, а Power Query способен выбирать данные из XML, в том числе и из нескольких файлов, то нет препятствий к тому, чтобы пользователь Excel получил доступ к данным из файла Visio. Причем для этого даже не требуется установленный Visio. Только файл документа и Power Query.</p>
<div class="jcomments-links"><a class="readmore-link" href="8-iz-visio-v-excel-cherez-power-query.html" title="Из Visio в Excel через Power Query"> Подробнее: Из Visio в Excel через Power Query</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 20 March 2019</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="7-obnovlenie-makrosov-s-pomoshchyu-vbs.html">Обновление макросов с помощью VBS</a></h2></div>

		
<div itemprop="articleBody">
		<p>Если макрос делается не для одного документа, то рано или поздно придется столкнуться с задачей его обновления. Пришла в голову умная мысль, улучшили макрос в одном из документов и возникает вопрос - а что делать с остальными? В них-то тоже хорошо бы провести изменение. Иногда задача еще усложняется - документы могут быть разбросаны по разным машинам и даже по разным организациям.</p>
<p>Конечно все можно сделать вручную. Разослать всем сообщения с указанием, что нужно изменить, и пусть меняют сами. Если не умеют, то придется сопроводить более или менее подробной инструкцией. Пользователям это обычно не нравится.</p>
<div class="jcomments-links"><a class="readmore-link" href="7-obnovlenie-makrosov-s-pomoshchyu-vbs.html" title="Обновление макросов с помощью VBS"> Подробнее: Обновление макросов с помощью VBS</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 27 February 2019</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="5-avtomatizatsiya-masshtabirovaniya-dokumenta.html">Автоматизация масштабирования документа</a></h2></div>


<div class="pull-left item-image"> <img src="/blog/5_f/gauge_demo.gif" alt="" itemprop="image"> </div>
<div itemprop="articleBody">
		<p>Как-то встретилась задача, в которой нужно было провести несколько измерений и собрать данные в отчет. А если ближе к теме, то рассчитать длину новогодних гирлянд для украшения дома. Причем для заказчика - это повторяющаяся задача, то есть желательно было ее автоматизировать.</p>
<p>На входе имеется фотография дома. Напрашивается решение - импортировать в Visio картинку, нарисовать на ней гирлянды и подсчитать длину.</p>
<div class="jcomments-links"><a class="readmore-link" href="5-avtomatizatsiya-masshtabirovaniya-dokumenta.html" title="Автоматизация масштабирования документа"> Подробнее: Автоматизация масштабирования документа</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 04 February 2019</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="6-avtomatizatsiya-masshtabirovaniya-risunka.html">Автоматизация масштабирования рисунка</a></h2></div>


<div itemprop="articleBody">
		<p>В статье <a href="http://testdomain12.epizy.com/blog/5-avtomatizatsiya-masshtabirovaniya-dokumenta.html">"Автоматизация масштабирования документа"</a> я рассказал о том случае, когда нужно было масштаб документа подстроить под рисунок. Но бывает необходимость и в обратной операции, когда масштаб рисунка жестко задан, а нужно подстроить размеры картинки.</p>
<p>В следующей задаче нужно было отрисовать корабль (палубу). Исходная картинка (хоть и сделана с чертежа) поступает в виде PDF, то есть ни о каком масштабе можно и не говорить. В Visio она перенесена в виде скриншота с фрагмента PDF документа.</p>
<p>Задача - изменить размеры картинки.</p>
<div class="jcomments-links"><a class="readmore-link" href="6-avtomatizatsiya-masshtabirovaniya-risunka.html" title="Автоматизация масштабирования рисунка"> Подробнее: Автоматизация масштабирования рисунка</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 04 February 2019</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="4-vyvod-otcheta-wsh-v-internet-explorer.html">Вывод отчета WSH в Internet Explorer</a></h2></div>
		
<div itemprop="articleBody">
		<p>Вот сделал утилитку для вывода отчета в виде таблицы из скрипта. Всегда этого не хватало.</p>
<p>Известно, что для автоматизации Visio можно использовать не только VBA и различные виды Add-On и Add-In, но и скрипты на js, vbs, python и т.д. Скрипты хороши тем, что им не нужны никакие инсталляторы, они не мешают безопасности Visio и не требует наличия в системе каких-либо дополнительных компонентов. Вот только с представлением данных небольшая проблема. Строку с результатом вывести легко. А если нужна табличка, то приходится выводить в файл, который потом нужно открывать в другом приложении.</p>
<p>Решил побороть эту проблему с помощью Internet Explorer. Раз уж он есть в любой Windows системе, пусть поработает. В результате получилась процедура, которая выводит произвольный массив в виде таблички.</p>
<div class="jcomments-links"><a class="readmore-link" href="4-vyvod-otcheta-wsh-v-internet-explorer.html" title="Вывод отчета WSH в Internet Explorer"> Подробнее: Вывод отчета WSH в Internet Explorer</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 28 January 2019</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="3-zapushchen-visio-navigator.html">Запущен Visio Navigator</a></h2></div>

		
<div class="pull-left item-image"> <img src="3_f/nv200.jpg" alt="" itemprop="image"> </div>
			<div itemprop="articleBody">
		<p>&nbsp;В интернете много информации. Но мусора еще больше. И отыскать ответ на нужный вопрос бывает очень даже нелегко. Сколько раз на форумах ведел фразу - "я даже не знаю, по каким словам это нужно гуглить". Поэтому наряду с поиском хотелось бы иметь некий каталог, иерархический указатель информации по нужному предмету. Проект такого указателя по Microsoft Visio вылился в Visio Navigator.</p>
<div class="jcomments-links"><a class="readmore-link" href="3-zapushchen-visio-navigator.html" title="Запущен Visio Navigator"> Подробнее: Запущен Visio Navigator</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 15 January 2019</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="2-otchety-visio.html">Отчеты Visio</a></h2></div>


<div itemprop="articleBody">
		<p>Может быть вы обращали внимание, что многие расширения Visio сопровождаются примерами отчетов, сделанных специально под эти расширения. Более двух десятков отчетов. И это неспроста. Отчет является эффективным средством для сбора информации из готового документа Visio. Практически не затрачивая дополнительных усилий, вы можете сформировать файл Excel или XML, содержащий выбранные данные. При этом доступны такие функции как отбор нужных шейпов, сортировка, группировка и консолидация данных. А так как определение отчета можно сохранять для последующего использования, можно заранее подготовить набор типовых отчетов, которые будут использоваться в вашей деятельности.</p>
<div class="jcomments-links"><a class="readmore-link" href="2-otchety-visio.html" title="Отчеты Visio"> Подробнее: Отчеты Visio</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 28 December 2018</time></dd></dl></div><!-- end articleBody -->
<div class="page-header"> <h2> <a href ="1-start-bloga.html">Старт блога</a></h2></div>
		
<div itemprop="articleBody">
		<p>Начинаем осваивать новый блог. На данный момент еще пустой.</p>
<p>Это попытка объединить сайт и блог из проекта visio.artberg.ru, visio-all.blogspot.com, visio.getbb.ru на новом хостинге. Теперь тройка выглядит как visioport.ru, visioport.ru/blog, visio.getbb.ru. Можно было бы подтянуть на единый хостинг еще и форум, но пока повременим. Ему, вроде, на данный момент ничто не угрожает, так что пусть остается на том месте, где пригрелся.</p>
<p>&nbsp;</p>	</div>


<div class="jcomments-links"><a class="readmore-link" href="1-start-bloga.html" title="Старт блога"> Подробнее: Старт блога</a></div><dl class="muted"><dt class="article-info-term"></dt><dd>Категория: <a href="index.html">Блог</a></dd> <dd><time>Опубликовано: 18 December 2018</time></dd></dl></div><!-- end articleBody -->
</div>
</main>
<!-- End Content -->
<div id="aside" class="span3">
<div class="well">
<h3 class="page-header">Меню</h3>
<ul class="category-module mod-list">
<li><a class="mod-articles-category-title active" href="/index.html">Сайт</a></li>
<li><a class="mod-articles-category-title active" href="https://visio.getbb.ru">Форум</a></li>
<li><a class="mod-articles-category-title active" href="index.html">
Блог</a></li>
<li><a class="mod-articles-category-title active" href="m-loads.html">
Загрузка</a></li>
<li><a class="mod-articles-category-title active" href="primer.html">
Как это устроено</a></li>
</ul>
</div>
<div class="well">
<h3 class="page-header">Блог</h3>
<ul class="category-module mod-list">
<li><a class="mod-articles-category-title active" href="35-treeview-cloud.html">
Документирование облачных хранилищ в Visio TreeView</a></li>
<li><a class="mod-articles-category-title active" href="34-thedocref.html">
Опасные ссылки на TheDoc в Visio</a></li>
<li><a class="mod-articles-category-title active" href="33-matchondrop.html">
Разбираемся с галочкой Match master by name on drop</a></li>
<li><a class="mod-articles-category-title active" href="32-visio-package-helper.html">
Опыты с утилитой для просмотра пакетного формата Visio</a></li>
<li><a class="mod-articles-category-title active" href="31-ribb-vba.html">
Вызов макросов из риббона в Visio</a></li>
<li><a class="mod-articles-category-title active" href="30-shape-data.html">
Shape Data Window и отложенные события</a></li>
<li><a class="mod-articles-category-title active" href="19-sozdanie-slozhnykh-formul-v-visio-s-pomoshchyu-excel.html">
Создание сложных формул в Visio с помощью Excel</a></li>
<li><a class="mod-articles-category-title active" href="18-registratsiya-sobytij-visio.html">
Регистрация событий Visio</a></li>
<li><a class="mod-articles-category-title active" href="17-funktsiya-filename-i-vse-takoe.html">
Функция FILENAME() и все такое</a></li>
<li><a class="mod-articles-category-title active" href="16-help-kartinka.html">
Help-картинка</a></li>
<li><a class="mod-articles-category-title active" href="15-polzovatelskaya-spravka-dlya-shejpov.html">
Пользовательская справка для шейпов</a></li>
<li><a class="mod-articles-category-title active" href="14-sluchaj-s-zashchitoj-ot-vozdejstviya-tem-v-visio.html">
Случай с защитой от воздействия тем в Visio</a></li>
<li><a class="mod-articles-category-title active" href="13-pro-kontekstnye-menyu.html">
Про контекстные меню</a></li>
<li><a class="mod-articles-category-title active" href="12-skorost-avtokonnekta-shejpov.html">
Скорость автоконнекта шейпов</a></li>
<li><a class="mod-articles-category-title active" href="11-lokalizatsiya-i-razdeliteli-v-visio.html">
Локализация и разделители в Visio</a></li>
<li><a class="mod-articles-category-title active" href="10-metody-indikatsii-rezultatov.html">
Методы индикации результатов</a></li>
<li><a class="mod-articles-category-title active" href="9-osobennosti-metoda-drop-shape.html">
Особенности метода Drop Shape</a></li>
<li><a class="mod-articles-category-title active" href="8-iz-visio-v-excel-cherez-power-query.html">
Из Visio в Excel через Power Query</a></li>
<li><a class="mod-articles-category-title active" href="7-obnovlenie-makrosov-s-pomoshchyu-vbs.html">
Обновление макросов с помощью VBS</a></li>
<li><a class="mod-articles-category-title active" href="5-avtomatizatsiya-masshtabirovaniya-dokumenta.html">
Автоматизация масштабирования документа</a></li>
<li><a class="mod-articles-category-title active" href="6-avtomatizatsiya-masshtabirovaniya-risunka.html">
Автоматизация масштабирования рисунка</a></li>
<li><a class="mod-articles-category-title active" href="4-vyvod-otcheta-wsh-v-internet-explorer.html">
Вывод отчета WSH в Internet Explorer</a></li>
<li><a class="mod-articles-category-title active" href="3-zapushchen-visio-navigator.html">
Запущен Visio Navigator</a></li>
<li><a class="mod-articles-category-title active" href="2-otchety-visio.html">
Отчеты Visio</a></li>
<li><a class="mod-articles-category-title active" href="1-start-bloga.html">
Старт блога</a></li>
</ul>
</div>
<div class="well">
<h3 class="page-header">Загрузка</h3>
<ul class="category-module mod-list">
<li><a class="mod-articles-category-title active" href="28-counters.html">
Трафарет счетчиков электроэнергии для Visio</a></li>
<li><a class="mod-articles-category-title active" href="27-meandr-stencils.html">
Трафареты электрики Меандр для Visio</a></li>
</ul>
</div>
<div class="well">
<h3 class="page-header">Как это устроено</h3>
<ul class="category-module mod-list">
<li><a class="mod-articles-category-title active" href="29-macro-in-stencil.html">
Движок для макросов в трафарете</a></li>
<li><a class="mod-articles-category-title active" href="26-list2level.html">
Двухуровневый список в данных шейпа</a></li>
<li><a class="mod-articles-category-title active" href="25-shejp-dlya-otobrazheniya-sobytij.html">
Шейп для отображения событий</a></li>
<li><a class="mod-articles-category-title active" href="23-smart-shejp-printer.html">
Смарт-шейп Принтер</a></li>
<li><a class="mod-articles-category-title active" href="24-smart-shejp-aktivy.html">
Смарт-шейп Активы</a></li>
<li><a class="mod-articles-category-title active" href="20-peremeshchenie-dereva.html">
Перемещение дерева</a></li>
<li><a class="mod-articles-category-title active" href="21-dinamicheskoe-otslezhivanie-konnektov.html">
Динамическое отслеживание коннектов</a></li>
</ul>
</div>
</div>
																							
</div> <!-- row-fluid -->
</div> <!-- Container -->
</div> <!-- class-body -->
																					
	<!-- Footer -->
	<footer class="footer" role="contentinfo">
		<div class="container">
			<hr>
			<p>© 2022 VisioPort blog</p>
		</div>
	</footer>
	</body>
</html>
