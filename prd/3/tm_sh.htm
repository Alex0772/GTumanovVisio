<html>
<head>
<title>Шейп графика</title>
<meta name="GENERATOR" content="MSHTML 5.00.2614.3500">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<LINK REL="STYLESHEET" HREF="vis.css">
<link rel="icon" href="favicon.ico" />
</head>
<body bgcolor="white">
<div class="body_div">
<table class="tft" width="100%"><tr>
<td width="20%" align="center"><a href="index.html"><img SRC="vl1.gif" WIDTH="177" HEIGHT="80" BORDER="0" ALT=""></a>&nbsp;</td>
<td width="10%" align="center">&nbsp;</td>
<td class='menutd' width="70%" align="center">
 <a class="menu" href="http://visio.getbb.ru/">Форум visio.getbb.ru</a> |
 <a class="menu" href="reg.htm">О форумах</a>
<br/>
 <a class="menu" href="bib.htm">Библиотека</a> |
 <a class="menu" href="faq.htm">Частые вопросы</a> |
 <a class="menu" href="bookpdf.htm">Литература</a> |
 <a class="menu" href="loading.htm">Склад материалов</a>
<br/>
 <a class="menu" href="navi/png_1.htm">Visio Navigator</a> |
 <a class="menu" href="blog/">Blog</a> |
 <a class="menu" href="inforesurs.htm">Полезные ссылки</a> |
 <a class="menu" href="site.htm">О сайте</a>
<br/>
 <a class="menu" href="visicorp.htm">История Visio</a> |
 <a class="menu" href="product.htm">Продукты Visio</a>
</td></tr></table>
<table width="100%" cellpadding="0" cellspacing="0" class="min"><tr><td width="10%" align="center">&nbsp;</td>
	<td width="90%">&nbsp;&nbsp;Для русскоязычных пользователей Visio. Начинающих и профессионалов.
Где взять, как сделать, что купить и т.д.
</td></tr></table>
<!-- основной контент -->
<!-- --------------------------- -->

<h1>Шейп графика</h1>
<p>В <A HREF="/prd/2/tm_gr.htm">tm_gr.htm</A>
показано, как легко строить графики измерений с помощью макроса. То есть достаточно иметь такой
универсальный построитель, чтобы можно было быстро визуализировать поведение процесса.</p>
<p>Однако есть еще более минималистический способ построения графиков. Представим, что существует
мастер-шейп, который позиционируется на листе в соответствии с внешними данными. И мы знаем,
что Visio позволяет одной операцией связать множество строк внешних данных с мастер-шейпом.</p>
<p>Напрашивается такой способ построения графиков:</p>
<p>1. Собрать последовательность измерений в БД или Excel и подключить их к документу Visio
в качестве внешних данных.</p>
<p>2. Подготовить мастер-шейп и селектировать его.</p>
<p>3. "Перенести" множество строк источника на страницу рисунка.</p>
<p>При этом Visio создаст множество копий мастер-шейпа, связанных с записями внешних данных,
и эти копии выстроятся на листе в соответствии с значениями данных. Примерно так, как
показано на рисунке.</p>
<IMG SRC="shData.gif" WIDTH="698" HEIGHT="507" BORDER="0" ALT="">
<p>Шейпы сами выстраиваются в нужный нам график.</p>
<p>Естественно, такой шейп будет не универсален. Вид графика будет определяться заложенными
в шейп формулами, связывающими данные и координаты шейпа и отображаемый текст. И весь график
будет жестко позиционирован на листе, так как данные непосредственно передаются в координаты.
То есть даже при копировании графика на другой лист все шейпы будут вставать в те же позиции относительно листа.</p>
<p>Однако и здесь можно найти приемы, повышающие гибкость метода.</p>
<h3>Копирование графика.</h3>
<p>Во-первых, построенное изображение может быть сохранено в формате рисунка (.gif, .jpeg, .emf...).
В таком виде оно легко транспортируется и может быть вставлено в любой другой документ.</p>
<p>Во-вторых, достаточно после построения сгруппировать полученное изображение, и мобильность
его существенно увеличится. Теперь координаты будут привязаны уже не к листу, а к группе.
Группа в целом легко транспортируется в нужное место.</p>
<h3>Управление параметрами</h3>
<p>Кроме того, шейп может иметь дополнительные данные для передачи параметров. А так как Visio
позволяет изменять такие данные через окно "Данные шейпа" сразу в множестве селектированных
шейпов, мы получаем возможность смещать весь график, или некоторые шейпы, или отдельные элементы.
Например, управлять смещением текста, как это показано ниже.</p>
<IMG SRC="shData2.gif" WIDTH="619" HEIGHT="362" BORDER="0" ALT="">
<p>Кроме того, никто не требует связывать все записи внешних данных одновременно. Значит, можно
формировать график удобными группами, соответственно подкрашивая новые шейпы (изменяя цвет,
толщину и т.д.). В результате график получается достаточно информативным.</p>
<h3>Использование</h3>
<p>Загрузить <A HREF="/store/shg.rar">отсюда</A>.
Файл SHgraph.vsd содержит мастер-шейп m (в Document stencil). Вместе с файлом Visio поставляется
файл Excel с примером данных. </p>
<p>Мастер-шейп может быть использован как внутри данного документа, так и в любом другом месте.</p>
<h3>Конструкция</h3>
<p>Для исследования конструкции шейпа воспользуемся удобным инструментом VisioGraph. Создадим
новый документ по этому шаблону, перенесем в него шейп m и выполним функцию "Граф / Импорт шейпа".
Инструмент построит граф зависимостей между ячейками шейп-листа, который после некоторого
ручного упорядочения примет следующий вид.</p>
<IMG SRC="grf.jpg" WIDTH="661" HEIGHT="349" BORDER="0" ALT="">
<p>Ячейки Prop (подкрашены слева) - это данные шейпа, которые и определяют его поведение.
Основные зависимости:</p>
<p>Свойство T (в примере - время события) - определяет основное смещение шейпа по горизонтали
(BeginX, EndX). Однако чтобы близкие по времени события не сливались, к смещению добавлена
зависимость от номера измерения N. Кроме того, свойство Xb определяет масштаб графика по горизонтали.</p>
<p>Свойство dY вводит смещение подписей по вертикали (через TxtPinX) относительно шейпа.</p>
<p>Свойство Yb смещает весь шейп по вертикали.</p>
<p>Более точные формулы зависимости можно просмотреть с помощью инструмента "ShapeComparer".
В том же документе Visio открываем трафарет UtiStans.vss и с помощью шейпа CompShape
сравниваем шейп m с простой линией.</p>
<IMG SRC="grf2.jpg" WIDTH="437" HEIGHT="272" BORDER="0" ALT="">
<p>В файле log.log находим различия, из которых выбираем существенные:</p>
<p>Sheet.1!BeginX = GUARD(Prop.Xb/4*Prop.T+Prop._VisDM_N*0.01) - смещение по X.</p>
<p>Sheet.1!BeginY = GUARD(Prop.Yb) - смещение по Y.</p>
<p>Sheet.1!EndY = GUARD(BeginY+2) - длина линии (высота).</p>
<p>Sheet.1!TxtPinX = GUARD(Width*0.05*Prop._VisDM_N-Prop.dY) - смещение текста.</p>
<p>Sheet.1!TxtPinY = GUARD(0)</p>
<p>Sheet.1!Fields.Value = Prop.Event - подпись измерения.</p>
<p>То есть вот такими несколькими не очень сложными формулами задается поведение шейпа,
с помощью которого без программирования строится график наступления событий во времени.</p>
<h3>Другие продукты</h3>
<p>Возможно, вам будет интересно ознакомиться с другими продуктами, размещенными на <A HREF="http://forvisio.blogspot.ru/p/downloads.html">http://forvisio.blogspot.ru/p/downloads.html</A> .</p>
<p>Если вам требуется адаптировать шаблон под ваши условия применения, обращайтесь к автору.</p>

<!-- --------------------------- -->
<!-- --------------------------- -->
<div id="menu-line">
<a href="mailto:gCroc@yandex.ru">Gennady Tumanov</a>
</div>

</div>
</body>
</html>
