<html>
<head>
<title>Шаблон телеметрического графика</title>
<meta name="GENERATOR" content="MSHTML 5.00.2614.3500">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<LINK REL="STYLESHEET" HREF="vis.css">
<link rel="icon" href="favicon.ico" />
</head>
<body bgcolor="white">
<div class="body_div">
<table class="tft" width="100%"><tr>
<td width="20%" align="center"><a href="index.html"><img SRC="vl1.gif" WIDTH="177" HEIGHT="80" BORDER="0" ALT=""></a>&nbsp;</td>
<td width="10%" align="center">&nbsp;</td>
<td class='menutd' width="70%" align="center">
 <a class="menu" href="http://visio.getbb.ru/">Форум visio.getbb.ru</a> |
 <a class="menu" href="reg.htm">О форумах</a>
<br/>
 <a class="menu" href="bib.htm">Библиотека</a> |
 <a class="menu" href="faq.htm">Частые вопросы</a> |
 <a class="menu" href="bookpdf.htm">Литература</a> |
 <a class="menu" href="loading.htm">Склад материалов</a>
<br/>
 <a class="menu" href="navi/png_1.htm">Visio Navigator</a> |
 <a class="menu" href="blog/">Blog</a> |
 <a class="menu" href="inforesurs.htm">Полезные ссылки</a> |
 <a class="menu" href="site.htm">О сайте</a>
<br/>
 <a class="menu" href="visicorp.htm">История Visio</a> |
 <a class="menu" href="product.htm">Продукты Visio</a>
</td></tr></table>
<table width="100%" cellpadding="0" cellspacing="0" class="min"><tr><td width="10%" align="center">&nbsp;</td>
	<td width="90%">&nbsp;&nbsp;Для русскоязычных пользователей Visio. Начинающих и профессионалов.
Где взять, как сделать, что купить и т.д.
</td></tr></table>
<!-- основной контент -->
<!-- --------------------------- -->

<h1>Шаблон телеметрического графика</h1>
<p>Шаблон содержит макрос, позволяющий в один клик отобразить последовательность измерений,
снабдив ее оцифрованными шкалами. Процесс построения графика показан в видео <a href="tmGraph.exe">tmGraph.exe</a> </p>
<p>Результат построения имеет примерно такой вид:</p>
<IMG SRC="r1.jpg" WIDTH="842" HEIGHT="222" BORDER="0" ALT="<IMG>">
<h3>Основные характеристики:</h3>
<UL>
	<LI>Данные измерений должны быть собраны в таблицу (Excel, Access или другая БД)
и присоединены к файлу Visio в качестве внешних данных.
	<LI>Вид графика - ломаная линия, отображающая зависимость F(n).
	<LI>Оцифровки осей координат рассчитываются автоматически.
	<LI>Шаблон позволяет отобразить как весь набор данных, так и выбранный интервал.
	<LI>Изображение легко масштабируется и переносится в другой документ.
</UL>
<h3>Управление</h3>
<p>Пользовательский интерфейс реализован в виде контекстного меню и Drag&Drop операций.
Выполняются следующие команды меню:</p>
<UL>
	<LI>построить график – собственно построение;
	<LI>очистить – сбрасывается граница временного интервала (в двух шейпах);
</UL>
<p>Выполняются следующие Drag&Drop операции:</p>
<UL>
	<LI>установить начало интервала – выполняется путем транспортировки строки измерения на шейп начала интервала;
	<LI>установить конец интервала – выполняется путем транспортировки строки измерения на шейп конца интервала.
</UL>
<p>Кроме того допускается изменение размеров изображения путем ручного перемещения границ заготовки.</p>
<p>Подключение источника внешних данных производится штатными средствами Visio.</p>
<h3>Конструкция</h3>
<p>Инструмент выполнен в виде файла Visio с поддержкой макросов.</p>
<p>Макрос выбирает данные из первого DataRecordSet. По умолчанию выбираются все записи данных.</p>
<p>В случае ограничения интервала изменяется SQL запрос выбора данных из источника и
выборка обновляется. В фильтре используется поле N. Имена колонок в источнике данных
должны оставаться неизменными.</p>
<p>VBA проект содержит модуль UtiMod и два простейших класса данных (без функционала).
(Форма и модуль ThisDocument в последней версии программы не используются).</p>
<h3>Требования к входным данным</h3>
<p>В примере в качестве источника данных задан Excel файл IE_events.xlsx.
Так как Visio по умолчанию использует абсолютную адресацию, при перемещении
файлов требуется обновить связь с источником.</p>
<p>Данные в файле имеют следующий формат:</p>
<TABLE Border=0  width='60%'>
<TR>
	<TD width='10%'>N</TD>
	<TD width='10%'>T</TD>
	<TD>Event</TD>
</TR>
<TR>
	<TD>1</TD>
	<TD>0.06</TD>
	<TD>IE_BeforeNavigate2</TD>
</TR>
<TR>
	<TD>2</TD>
	<TD>0.06</TD>
	<TD>IE_DownloadBegin</TD>
</TR>
<TR>
	<TD>3</TD>
	<TD>0.48</TD>
	<TD>DownloadComplete</TD>
</TR>
<TR>
	<TD>4</TD>
	<TD>0.48</TD>
	<TD>IE_DownloadBegin</TD>
</TR>
</TABLE>
<p>Вы можете использовать другие источники данных. При этом должны соблюдаться следующие условия:</p>
<UL>
	<LI>имена колонок должны быть такими, как в примере;
	<LI>первая колонка содержит последовательные номера измерений;
	<LI>вторая колонка содержит значения измерений;
	<LI>третья колонка (не обязательная) содержит подписи измерений.
</UL>
<h3>Применение (установка)</h3>
<p>Загрузить <A HREF="/store/TMG.rar">отсюда</A>.</p>
<p>Вместе с файлом Visio поставляется файл Excel, который содержит пример данных и может использоваться в дальнейшем в качестве образца.</p>
<p>К файлу Visio можно подключать не только файл Excel, но и любую базу данных, которая может быть подключена как внешние данные. Перед подключением нового источника данных старый должен быть удален, потому что макрос работает только с первым источником.</p>
<h3>Другие продукты</h3>
<p>Возможно, вам будет интересно ознакомиться с другими продуктами, размещенными на <A HREF="http://forvisio.blogspot.ru/p/downloads.html">http://forvisio.blogspot.ru/p/downloads.html</A> .</p>
<p>Если вам требуется адаптировать шаблон под ваши условия применения, обращайтесь к автору.</p>
<p>Связаться с автором: <a href="mailto:gCroc@yandex.ru">gCroc@yandex.ru</a>.</p>

<!-- --------------------------- -->
<!-- --------------------------- -->
<div id="menu-line">
<a href="mailto:gCroc@yandex.ru">Gennady Tumanov</a>
</div>

</div>
</body>
</html>
