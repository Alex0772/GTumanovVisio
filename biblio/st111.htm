<html>
<head>
<title>Памятка по наконечникам Visio Line ends</title>
<meta name="GENERATOR" content="MSHTML 5.00.2614.3500">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<LINK REL="STYLESHEET" HREF="vis.css">
<link rel="icon" href="favicon.ico" />
</head>
<body bgcolor="white">
<div class="body_div">
<table class="tft" width="100%"><tr>
<td width="20%" align="center"><a href="index.html"><img SRC="vl1.gif" WIDTH="177" HEIGHT="80" BORDER="0" ALT=""></a>&nbsp;</td>
<td width="10%" align="center">&nbsp;</td>
<td class='menutd' width="70%" align="center">
 <a class="menu" href="http://visio.getbb.ru/">Форум visio.getbb.ru</a> |
 <a class="menu" href="reg.htm">О форумах</a>
<br/>
 <a class="menu" href="bib.htm">Библиотека</a> |
 <a class="menu" href="faq.htm">Частые вопросы</a> |
 <a class="menu" href="bookpdf.htm">Литература</a> |
 <a class="menu" href="loading.htm">Склад материалов</a>
<br/>
 <a class="menu" href="navi/png_1.htm">Visio Navigator</a> |
 <a class="menu" href="blog/">Blog</a> |
 <a class="menu" href="inforesurs.htm">Полезные ссылки</a> |
 <a class="menu" href="site.htm">О сайте</a>
<br/>
 <a class="menu" href="visicorp.htm">История Visio</a> |
 <a class="menu" href="product.htm">Продукты Visio</a>
</td></tr></table>
<table width="100%" cellpadding="0" cellspacing="0" class="min"><tr><td width="10%" align="center">&nbsp;</td>
	<td width="90%">&nbsp;&nbsp;Для русскоязычных пользователей Visio. Начинающих и профессионалов.
Где взять, как сделать, что купить и т.д.
</td></tr></table>
<!-- основной контент -->

<h1>Памятка по наконечникам Visio Line ends</h1>
<p align="Right">Геннадий Туманов. 25 сентября 2016 г.</p>

<p align="Justify">Штатный набор из 45 штук. Можно рисовать и добавлять свои
(пользовательские).</p>

<IMG SRC="r111/image002.png" WIDTH="400" HEIGHT="88" BORDER="0" ALT="">

<p align="Justify">В режиме <b><i>без масштабирования</i></b> в качестве опоры
берется основная линия (та, к которой крепится наконечник). Расчеты ведутся от
ее толщины. Сильно влияет также переключатель размеров. Размеры образца
практически не принимаются во внимание.</p>
<p align="Justify">В режиме <b><i>с масштабированием</i></b> отсчет начинается
от размеров образца. И этот размер сохраняется постоянным во всех образованных
от него экземплярах. Свои наборы можно делать как с масштабированием, так и без
него.</p>
<p align="Justify"><b><i>Штатные наборы</i></b> - отличаются тем, что зависимость от толщины
основной линии ослаблена. Основное управление - от переключателя размеров.</p>
<h3>Штатные наконечники</h3>
<p align="Justify">Образец выбирается из выпадающего&nbsp;списка в окне
форматирования линии.</p>

<IMG SRC="r111/image003.png" WIDTH="187" HEIGHT="200" BORDER="0" ALT="">
<IMG SRC="r111/image005.png" WIDTH="320" HEIGHT="168" BORDER="0" ALT="">

<p align="Justify">В том же окне есть и переключатель размеров на 7 положений.
Диапазон изменения - примерно в 10 раз. При толщине линии 01 для штатного
образца 01 и масштабе документа 1:1 размер наконечника для разных значений
переключателя изменяется от 0,6 до 6,5 мм.</p>
<p align="Justify">От толщины основной линии размер практически не зависит. Порядка
10% на весь диапазон (например, от 6,5 до 7,5 мм).</p>
<p align="Justify">Толщина линии наконечника всегда равна толщине основной
линии. Цвет наконечника тоже берется от основной линии.</p>

<IMG SRC="r111/image007.png" WIDTH="252" HEIGHT="146" BORDER="0" ALT="">

<p align="Justify">При изменении масштаба документа видимый размер наконечника
(на экране) не изменяется. Значит в реальных единицах он изменяется
пропорционально масштабу. То есть если при масштабе 1:1 наконечник оценивался в
7.5 мм, то при масштабе 1:5 он будет оценен уже в 37.5 мм.</p>

<IMG SRC="r111/image009.png" WIDTH="200" HEIGHT="138" BORDER="0" ALT="">
<IMG SRC="r111/image011.png" WIDTH="200" HEIGHT="153" BORDER="0" ALT="">

<h3>Пользовательские без масштабирования</h3>
<p align="Justify">Фрагменты образца обязательно должны быть соединены или
сгруппированы. То есть образец - это всегда один шейп.</p>
<p align="Justify">Размер рассчитывается от толщины основной линии и сравним с
ней. При положении переключателя "Средний" группа точно выравнивается
по толщине основной линии. Реальный размер в окне редактирования образца не
имеет значения.</p>
<p align="Justify">Для увеличения размера изображение приходится выводить за группу.</p>

<IMG SRC="r111/image013.png" WIDTH="281" HEIGHT="320" BORDER="0" ALT="">

<p align="Justify">В приведенном примере наконечник будет в 10 раз больше
толщины основной линии (при положении переключателя Средний).</p>
<p align="Justify">Основная линия будет доходить до левого края группы, поэтому
для стрелок центр вращения группы смещают влево. И изображение утыкают в ту же
точку.</p>
<p align="Justify">Зависимости от толщины и переключателя размеров:</p>

<IMG SRC="r111/image015.png" WIDTH="200" HEIGHT="198" BORDER="0" ALT="">
<IMG SRC="r111/image017.png" WIDTH="185" HEIGHT="200" BORDER="0" ALT="">

<p align="Justify">Специальный прием - для отслеживания толщины основной линии
толщина линии наконечника устанавливается в 0pt. Иначе она будет постоянной.</p>
<p align="Justify">Если линии у наконечника черные, они будут принимать цвет основной линии.
Во избежание этого нужно делать их "не совсем черными".</p>

<IMG SRC="r111/image025.jpg" WIDTH="200" HEIGHT="103" BORDER="0" ALT="">

<h3>Пользовательские масштабируемые</h3>
<p align="Justify">Фрагменты образца также должны быть соединены или
сгруппированы.</p>
<p align="Justify">Размер строго соответствует размеру в окне редактирования
образца. Положение в окне не существенно, можно рисовать в любом месте.</p>
Выводить изображение за группу нет смысла, все равно размер
будет реальным.</p>
<p align="Justify">Толщина линии в экземплярах тоже строго соответствует
образцу. То есть при изменении толщины основной линии толщина линии наконечника
не изменится.</p>
<p align="Justify">Наконечник масштабируется вместе со страницей и другими
шейпами.</p>

<IMG SRC="r111/image019.png" WIDTH="200" HEIGHT="166" BORDER="0" ALT="">
<IMG SRC="r111/image021.png" WIDTH="200" HEIGHT="166" BORDER="0" ALT="">

<h3>Размещение и дополнительное управление</h3>
<p align="Justify">Штатные наконечники показываются только в списке в окне
формата линии. Перечень не изменяется.</p>
<p align="Justify">Пользовательские наконечники показываются в том же окне
(перечисляются наименования). Причем этот список управляемый.</p>
<p align="Justify">Пользовательскими образцы управляются через Document stencil, хотя их там не видно.</p>
Можно скрыть образцы из списка образцов в окне формата линии</p>

<div style="background-color: #eeeeee; margin-left: 1cm;">
ActiveDocument.Masters(2).Hidden = True</div>
Можно через бит-маску PatternFlags управлять некоторыми свойствами образцов</p>
<div style="background-color: #eeeeee; margin-left: 1cm;">
ActiveDocument.Masters(2).PatternFlags = &amp;H402&amp;</div>

<p align="Justify">Управление аналогично ручному переключению
"Поведения" и "Масштаба" в форме свойств образца.</p>

<IMG SRC="r111/image023.png" WIDTH="320" HEIGHT="216" BORDER="0" ALT="">

<h3>Выводы</h3>
<ul>
<li><b><i>Штатные наконечники</i></b> хороши для иллюстраций, деловой графики.
Полезно отслеживание толщины и цвета основной линии. Но нужно быть готовым к
тому, что при изменении масштаба документа все настройки наконечников придется
переделывать.</li>
<li><b><i>У пользовательских немасштабируемых</i></b> наконечников применение
примерно такое же. Добавляется зависимость размера от толщины основной линии.
Иногда это может мешать.</li>
<li><b><i>Пользовательские масштабируемые</i></b> наконечники хороши для схем,
чертежей, более строгих по сравнению с деловой графикой. Характеризуются
независимостью размера и толщины линии от условий применения.</li>
</ul>
<h3>Ссылки</h3>
<p align="Justify">Полезно заглянуть в MSDN - 
<a href="https://msdn.microsoft.com/en-us/library/aa200997%28office.10%29.aspx">
https://msdn.microsoft.com/en-us/library/aa200997%28office.10%29.aspx</a></p>

<!-- --------------------------- -->
<div id="menu-line">
<a href="mailto:gCroc@yandex.ru">Gennady Tumanov</a>
</div>

</div>
</body>
</html>
